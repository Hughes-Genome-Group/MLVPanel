!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=12)}([function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.unbgzf=t.igvxhr=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(11);var a=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,null,[{key:"load",value:function(e,t){return new Promise(function(i,n){var r,a,s,o,l=new XMLHttpRequest,h=t.sendData,u=t.method||(h?"POST":"GET"),c=t.range,f=t.responseType,d=t.contentType,p=t.mimeType,v=t.headers,g=(0==navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent),t.withCredentials);if(l.open(u,e),c){var y=c.size?c.start+c.size-1:"";l.setRequestHeader("Range","bytes="+c.start+"-"+y)}if(d&&l.setRequestHeader("Content-Type",d),p&&l.overrideMimeType(p),f&&(l.responseType=f),v)for(r=Object.keys(v),o=0;o<r.length;o++)s=v[a=r[o]],l.setRequestHeader(a,s);!0===g&&(l.withCredentials=!0),l.onload=function(t){0==l.status||l.status>=200&&l.status<=300?c&&206!=l.status?b("ERROR: range-byte header was ignored for url: "+e):i(l.response,l):416===l.status?b("Unsatisfiable range"):b("Error accessing resource: "+l.status)},l.onerror=function(t){b("Error accessing resource: "+e+" Status: "+l.status)},l.ontimeout=function(e){b("Timed out")},l.onabort=function(e){console.log("Aborted"),n(new igv.AbortLoad)};try{l.send(h)}catch(e){console.log(e)}function b(e){if(!n)throw Error(e);n(e)}})}},{key:"loadArrayBuffer",value:function(e,i){return void 0===i&&(i={}),i.responseType="arraybuffer",t.load(e,i)}},{key:"loadJson",value:function(e,i){return"POST"==(i.method||(i.sendData?"POST":"GET"))&&(i.contentType="application/json"),new Promise(function(n,r){t.load(e,i).then(function(e){n(e?JSON.parse(e):e)}).catch(r)})}},{key:"loadString",value:function(e,i){var n,r,a;return void 0===i&&(i={}),r=(a=e.indexOf("?"))>0?e.substring(0,a):e,0===(n=i.bgz?2:r.endsWith(".gz")?1:0)?(i.mimeType="text/plain; charset=x-user-defined",t.load(e,i)):(i.responseType="arraybuffer",new Promise(function(r,a){t.load(e,i).then(function(e){var i=t.arrayBufferToString(e,n);r(i)}).catch(a)}))}},{key:"loadStringFromFile",value:function(e,i){return new Promise(function(n,r){var a=new FileReader;i.range;a.onload=function(r){var s,o;s=i.bgz?2:e.name.endsWith(".gz")?1:0,o=t.arrayBufferToString(a.result,s),n(o,e)},a.onerror=function(t){console.log("reject uploading local file "+e.name),r(null,a)},a.readAsArrayBuffer(e)})}},{key:"isCrossDomain",value:function(e){var t=window.location.origin;return!e.startsWith(t)}},{key:"arrayBufferToString",value:function(t,i){for(var n,r="",a=0,o=(n=1===i?new e.Gunzip(new Uint8Array(t)).decompress():2===i?new Uint8Array(s(t)):new Uint8Array(t)).length;a<o;a++)r+=String.fromCharCode(n[a]);return r}}]),t}(),s=function(e,t){var i=[],n=[0],a=0;for(t=t||e.byteLength-18;n[0]<t;){var s=new Uint8Array(e,n[0],18),o=s[11]<<8|s[10],l=(s[12],s[13],s[15],s[14],s[17]<<8|s[16]+1),h=12+o+n[0],u=e.byteLength-h;if(u<l+8)break;var c=(0,r.jszlib_inflate_buffer)(e,h,u,n);n[0]+=8,a+=c.byteLength,i.push(c)}if(1==i.length)return i[0];for(var f=new Uint8Array(a),d=0,p=0;p<i.length;++p){var v=new Uint8Array(i[p]);(0,r.arrayCopy)(v,0,f,d,v.length),d+=v.length}return f.buffer};t.igvxhr=a,t.unbgzf=s}).call(this,i(1))},function(e,t){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){"use strict";function e(e){throw e}var t=void 0,i=!0,n=this;function r(e,i){var r,a=e.split("."),s=n;!(a[0]in s)&&s.execScript&&s.execScript("var "+a[0]);for(;a.length&&(r=a.shift());)a.length||i===t?s=s[r]?s[r]:s[r]={}:s[r]=i}var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;function s(t,i){this.index="number"==typeof i?i:0,this.m=0,this.buffer=t instanceof(a?Uint8Array:Array)?t:new(a?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&e(Error("invalid index")),this.buffer.length<=this.index&&this.f()}s.prototype.f=function(){var e,t=this.buffer,i=t.length,n=new(a?Uint8Array:Array)(i<<1);if(a)n.set(t);else for(e=0;e<i;++e)n[e]=t[e];return this.buffer=n},s.prototype.d=function(e,t,i){var n,r=this.buffer,a=this.index,s=this.m,o=r[a];if(i&&1<t&&(e=8<t?(f[255&e]<<24|f[e>>>8&255]<<16|f[e>>>16&255]<<8|f[e>>>24&255])>>32-t:f[e]>>8-t),8>t+s)o=o<<t|e,s+=t;else for(n=0;n<t;++n)o=o<<1|e>>t-n-1&1,8==++s&&(s=0,r[a++]=f[o],o=0,a===r.length&&(r=this.f()));r[a]=o,this.buffer=r,this.m=s,this.index=a},s.prototype.finish=function(){var e,t=this.buffer,i=this.index;return 0<this.m&&(t[i]<<=8-this.m,t[i]=f[t[i]],i++),a?e=t.subarray(0,i):(t.length=i,e=t),e};var o,l=new(a?Uint8Array:Array)(256);for(o=0;256>o;++o){for(var h=c=o,u=7,c=c>>>1;c;c>>>=1)h<<=1,h|=1&c,--u;l[o]=(h<<u&255)>>>0}var f=l;function d(e,t,i){var n,r="number"==typeof t?t:t=0,a="number"==typeof i?i:e.length;for(n=-1,r=7&a;r--;++t)n=n>>>8^v[255&(n^e[t])];for(r=a>>3;r--;t+=8)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^v[255&(n^e[t])])>>>8^v[255&(n^e[t+1])])>>>8^v[255&(n^e[t+2])])>>>8^v[255&(n^e[t+3])])>>>8^v[255&(n^e[t+4])])>>>8^v[255&(n^e[t+5])])>>>8^v[255&(n^e[t+6])])>>>8^v[255&(n^e[t+7])];return(4294967295^n)>>>0}var p=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],v=a?new Uint32Array(p):p;function g(){}function y(e){this.buffer=new(a?Uint16Array:Array)(2*e),this.length=0}function b(e){var t,i,n,r,s,o,l,h,u,c=e.length,f=0,d=Number.POSITIVE_INFINITY;for(h=0;h<c;++h)e[h]>f&&(f=e[h]),e[h]<d&&(d=e[h]);for(t=1<<f,i=new(a?Uint32Array:Array)(t),n=1,r=0,s=2;n<=f;){for(h=0;h<c;++h)if(e[h]===n){for(o=0,l=r,u=0;u<n;++u)o=o<<1|1&l,l>>=1;for(u=o;u<t;u+=s)i[u]=n<<16|h;++r}++n,r<<=1,s<<=1}return[i,f,d]}function _(e,t){this.k=k,this.I=0,this.input=a&&e instanceof Array?new Uint8Array(e):e,this.b=0,t&&(t.lazy&&(this.I=t.lazy),"number"==typeof t.compressionType&&(this.k=t.compressionType),t.outputBuffer&&(this.a=a&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.b=t.outputIndex)),this.a||(this.a=new(a?Uint8Array:Array)(32768))}g.prototype.getName=function(){return this.name},g.prototype.getData=function(){return this.data},g.prototype.X=function(){return this.Y},r("Zlib.GunzipMember",g),r("Zlib.GunzipMember.prototype.getName",g.prototype.getName),r("Zlib.GunzipMember.prototype.getData",g.prototype.getData),r("Zlib.GunzipMember.prototype.getMtime",g.prototype.X),y.prototype.getParent=function(e){return 2*((e-2)/4|0)},y.prototype.push=function(e,t){var i,n,r,a=this.buffer;for(i=this.length,a[this.length++]=t,a[this.length++]=e;0<i&&(n=this.getParent(i),a[i]>a[n]);)r=a[i],a[i]=a[n],a[n]=r,r=a[i+1],a[i+1]=a[n+1],a[n+1]=r,i=n;return this.length},y.prototype.pop=function(){var e,t,i,n,r,a=this.buffer;for(t=a[0],e=a[1],this.length-=2,a[0]=a[this.length],a[1]=a[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&a[n+2]>a[n]&&(n+=2),a[n]>a[r]);)i=a[r],a[r]=a[n],a[n]=i,i=a[r+1],a[r+1]=a[n+1],a[n+1]=i,r=n;return{index:e,value:t,length:this.length}};var m,k=2,w={NONE:0,v:1,o:k,aa:3},x=[];for(m=0;288>m;m++)switch(i){case 143>=m:x.push([m+48,8]);break;case 255>=m:x.push([m-144+400,9]);break;case 279>=m:x.push([m-256+0,7]);break;case 287>=m:x.push([m-280+192,8]);break;default:e("invalid literal: "+m)}_.prototype.g=function(){var n,r,o,l,h=this.input;switch(this.k){case 0:for(o=0,l=h.length;o<l;){var u,c,f,d=r=a?h.subarray(o,o+65535):h.slice(o,o+65535),p=(o+=r.length)===l,v=t,g=t,y=this.a,b=this.b;if(a){for(y=new Uint8Array(this.a.buffer);y.length<=b+d.length+5;)y=new Uint8Array(y.length<<1);y.set(this.a)}if(u=p?1:0,y[b++]=0|u,f=65536+~(c=d.length)&65535,y[b++]=255&c,y[b++]=c>>>8&255,y[b++]=255&f,y[b++]=f>>>8&255,a)y.set(d,b),b+=d.length,y=y.subarray(0,b);else{for(v=0,g=d.length;v<g;++v)y[b++]=d[v];y.length=b}this.b=b,this.a=y}break;case 1:var _=new s(a?new Uint8Array(this.a.buffer):this.a,this.b);_.d(1,1,i),_.d(1,2,i);var m,w,A,P=S(this,h);for(m=0,w=P.length;m<w;m++)if(A=P[m],s.prototype.d.apply(_,x[A]),256<A)_.d(P[++m],P[++m],i),_.d(P[++m],5),_.d(P[++m],P[++m],i);else if(256===A)break;this.a=_.finish(),this.b=this.a.length;break;case k:var T,M,U,E,L,C,O,D,B,z,R,j,$,N,H,W=new s(a?new Uint8Array(this.a.buffer):this.a,this.b),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=Array(19);for(T=k,W.d(1,1,i),W.d(T,2,i),M=S(this,h),O=F(C=I(this.V,15)),B=F(D=I(this.U,7)),U=286;257<U&&0===C[U-1];U--);for(E=30;1<E&&0===D[E-1];E--);var Z,G,X,K,Q,Y,J=U,ee=E,te=new(a?Uint32Array:Array)(J+ee),ie=new(a?Uint32Array:Array)(316),ne=new(a?Uint8Array:Array)(19);for(Z=G=0;Z<J;Z++)te[G++]=C[Z];for(Z=0;Z<ee;Z++)te[G++]=D[Z];if(!a)for(Z=0,K=ne.length;Z<K;++Z)ne[Z]=0;for(Z=Q=0,K=te.length;Z<K;Z+=G){for(G=1;Z+G<K&&te[Z+G]===te[Z];++G);if(X=G,0===te[Z])if(3>X)for(;0<X--;)ie[Q++]=0,ne[0]++;else for(;0<X;)(Y=138>X?X:138)>X-3&&Y<X&&(Y=X-3),10>=Y?(ie[Q++]=17,ie[Q++]=Y-3,ne[17]++):(ie[Q++]=18,ie[Q++]=Y-11,ne[18]++),X-=Y;else if(ie[Q++]=te[Z],ne[te[Z]]++,3>--X)for(;0<X--;)ie[Q++]=te[Z],ne[te[Z]]++;else for(;0<X;)(Y=6>X?X:6)>X-3&&Y<X&&(Y=X-3),ie[Q++]=16,ie[Q++]=Y-3,ne[16]++,X-=Y}for(n=a?ie.subarray(0,Q):ie.slice(0,Q),z=I(ne,7),N=0;19>N;N++)q[N]=z[V[N]];for(L=19;4<L&&0===q[L-1];L--);for(R=F(z),W.d(U-257,5,i),W.d(E-1,5,i),W.d(L-4,4,i),N=0;N<L;N++)W.d(q[N],3,i);for(N=0,H=n.length;N<H;N++)if(j=n[N],W.d(R[j],z[j],i),16<=j){switch(N++,j){case 16:$=2;break;case 17:$=3;break;case 18:$=7;break;default:e("invalid code: "+j)}W.d(n[N],$,i)}var re,ae,se,oe,le,he,ue,ce,fe=[O,C],de=[B,D];for(le=fe[0],he=fe[1],ue=de[0],ce=de[1],re=0,ae=M.length;re<ae;++re)if(se=M[re],W.d(le[se],he[se],i),256<se)W.d(M[++re],M[++re],i),oe=M[++re],W.d(ue[oe],ce[oe],i),W.d(M[++re],M[++re],i);else if(256===se)break;this.a=W.finish(),this.b=this.a.length;break;default:e("invalid compression type")}return this.a};var A=function(){function t(t){switch(i){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:e("invalid length: "+t)}}var n,r,a=[];for(n=3;258>=n;n++)r=t(n),a[n]=r[2]<<24|r[1]<<16|r[0];return a}(),P=a?new Uint32Array(A):A;function S(n,r){function s(t,n){var r,a,s,o,l=t.P,h=[],u=0;switch(r=P[t.length],h[u++]=65535&r,h[u++]=r>>16&255,h[u++]=r>>24,i){case 1===l:a=[0,l-1,0];break;case 2===l:a=[1,l-2,0];break;case 3===l:a=[2,l-3,0];break;case 4===l:a=[3,l-4,0];break;case 6>=l:a=[4,l-5,1];break;case 8>=l:a=[5,l-7,1];break;case 12>=l:a=[6,l-9,2];break;case 16>=l:a=[7,l-13,2];break;case 24>=l:a=[8,l-17,3];break;case 32>=l:a=[9,l-25,3];break;case 48>=l:a=[10,l-33,4];break;case 64>=l:a=[11,l-49,4];break;case 96>=l:a=[12,l-65,5];break;case 128>=l:a=[13,l-97,5];break;case 192>=l:a=[14,l-129,6];break;case 256>=l:a=[15,l-193,6];break;case 384>=l:a=[16,l-257,7];break;case 512>=l:a=[17,l-385,7];break;case 768>=l:a=[18,l-513,8];break;case 1024>=l:a=[19,l-769,8];break;case 1536>=l:a=[20,l-1025,9];break;case 2048>=l:a=[21,l-1537,9];break;case 3072>=l:a=[22,l-2049,10];break;case 4096>=l:a=[23,l-3073,10];break;case 6144>=l:a=[24,l-4097,11];break;case 8192>=l:a=[25,l-6145,11];break;case 12288>=l:a=[26,l-8193,12];break;case 16384>=l:a=[27,l-12289,12];break;case 24576>=l:a=[28,l-16385,13];break;case 32768>=l:a=[29,l-24577,13];break;default:e("invalid distance")}for(r=a,h[u++]=r[0],h[u++]=r[1],h[u++]=r[2],s=0,o=h.length;s<o;++s)y[b++]=h[s];m[h[0]]++,k[h[3]]++,_=t.length+n-1,p=null}var o,l,h,u,c,f,d,p,v,g={},y=a?new Uint16Array(2*r.length):[],b=0,_=0,m=new(a?Uint32Array:Array)(286),k=new(a?Uint32Array:Array)(30),w=n.I;if(!a){for(h=0;285>=h;)m[h++]=0;for(h=0;29>=h;)k[h++]=0}for(m[256]=1,o=0,l=r.length;o<l;++o){for(h=c=0,u=3;h<u&&o+h!==l;++h)c=c<<8|r[o+h];if(g[c]===t&&(g[c]=[]),f=g[c],!(0<_--)){for(;0<f.length&&32768<o-f[0];)f.shift();if(o+3>=l){for(p&&s(p,-1),h=0,u=l-o;h<u;++h)v=r[o+h],y[b++]=v,++m[v];break}0<f.length?(d=T(r,o,f),p?p.length<d.length?(v=r[o-1],y[b++]=v,++m[v],s(d,0)):s(p,-1):d.length<w?p=d:s(d,0)):p?s(p,-1):(v=r[o],y[b++]=v,++m[v])}f.push(o)}return y[b++]=256,m[256]++,n.V=m,n.U=k,a?y.subarray(0,b):y}function T(e,t,i){var n,r,a,s,o,l,h=0,u=e.length;s=0,l=i.length;e:for(;s<l;s++){if(n=i[l-s-1],a=3,3<h){for(o=h;3<o;o--)if(e[n+o-1]!==e[t+o-1])continue e;a=h}for(;258>a&&t+a<u&&e[n+a]===e[t+a];)++a;if(a>h&&(r=n,h=a),258===a)break}return new function(e,t){this.length=e,this.P=t}(h,t-r)}function I(e,t){var i,n,r,s,o,l=e.length,h=new y(572),u=new(a?Uint8Array:Array)(l);if(!a)for(s=0;s<l;s++)u[s]=0;for(s=0;s<l;++s)0<e[s]&&h.push(s,e[s]);if(i=Array(h.length/2),n=new(a?Uint32Array:Array)(h.length/2),1===i.length)return u[h.pop().index]=1,u;for(s=0,o=h.length/2;s<o;++s)i[s]=h.pop(),n[s]=i[s].value;for(r=function(e,t,i){function n(e){var i=p[e][v[e]];i===t?(n(e+1),n(e+1)):--f[i],++v[e]}var r,s,o,l,h,u=new(a?Uint16Array:Array)(i),c=new(a?Uint8Array:Array)(i),f=new(a?Uint8Array:Array)(t),d=Array(i),p=Array(i),v=Array(i),g=(1<<i)-t,y=1<<i-1;for(u[i-1]=t,s=0;s<i;++s)g<y?c[s]=0:(c[s]=1,g-=y),g<<=1,u[i-2-s]=(u[i-1-s]/2|0)+t;for(u[0]=c[0],d[0]=Array(u[0]),p[0]=Array(u[0]),s=1;s<i;++s)u[s]>2*u[s-1]+c[s]&&(u[s]=2*u[s-1]+c[s]),d[s]=Array(u[s]),p[s]=Array(u[s]);for(r=0;r<t;++r)f[r]=i;for(o=0;o<u[i-1];++o)d[i-1][o]=e[o],p[i-1][o]=o;for(r=0;r<i;++r)v[r]=0;for(1===c[i-1]&&(--f[0],++v[i-1]),s=i-2;0<=s;--s){for(l=r=0,h=v[s+1],o=0;o<u[s];o++)(l=d[s+1][h]+d[s+1][h+1])>e[r]?(d[s][o]=l,p[s][o]=t,h+=2):(d[s][o]=e[r],p[s][o]=r,++r);v[s]=0,1===c[s]&&n(s)}return f}(n,n.length,t),s=0,o=i.length;s<o;++s)u[i[s].index]=r[s];return u}function F(e){var t,i,n,r,s=new(a?Uint16Array:Array)(e.length),o=[],l=[],h=0;for(t=0,i=e.length;t<i;t++)o[e[t]]=1+(0|o[e[t]]);for(t=1,i=16;t<=i;t++)l[t]=h,h+=0|o[t],h<<=1;for(t=0,i=e.length;t<i;t++)for(h=l[e[t]],l[e[t]]+=1,n=s[t]=0,r=e[t];n<r;n++)s[t]=s[t]<<1|1&h,h>>>=1;return s}function M(e,t){this.input=e,this.b=this.c=0,this.i={},t&&(t.flags&&(this.i=t.flags),"string"==typeof t.filename&&(this.filename=t.filename),"string"==typeof t.comment&&(this.A=t.comment),t.deflateOptions&&(this.l=t.deflateOptions)),this.l||(this.l={})}M.prototype.g=function(){var e,i,n,r,s,o,l,h,u=new(a?Uint8Array:Array)(32768),c=0,f=this.input,p=this.c,v=this.filename,g=this.A;if(u[c++]=31,u[c++]=139,u[c++]=8,e=0,this.i.fname&&(e|=L),this.i.fcomment&&(e|=C),this.i.fhcrc&&(e|=E),u[c++]=e,i=(Date.now?Date.now():+new Date)/1e3|0,u[c++]=255&i,u[c++]=i>>>8&255,u[c++]=i>>>16&255,u[c++]=i>>>24&255,u[c++]=0,u[c++]=U,this.i.fname!==t){for(l=0,h=v.length;l<h;++l)255<(o=v.charCodeAt(l))&&(u[c++]=o>>>8&255),u[c++]=255&o;u[c++]=0}if(this.i.comment){for(l=0,h=g.length;l<h;++l)255<(o=g.charCodeAt(l))&&(u[c++]=o>>>8&255),u[c++]=255&o;u[c++]=0}return this.i.fhcrc&&(n=65535&d(u,0,c),u[c++]=255&n,u[c++]=n>>>8&255),this.l.outputBuffer=u,this.l.outputIndex=c,u=(s=new _(f,this.l)).g(),c=s.b,a&&(c+8>u.buffer.byteLength?(this.a=new Uint8Array(c+8),this.a.set(new Uint8Array(u.buffer)),u=this.a):u=new Uint8Array(u.buffer)),r=d(f,t,t),u[c++]=255&r,u[c++]=r>>>8&255,u[c++]=r>>>16&255,u[c++]=r>>>24&255,h=f.length,u[c++]=255&h,u[c++]=h>>>8&255,u[c++]=h>>>16&255,u[c++]=h>>>24&255,this.c=p,a&&c<u.length&&(this.a=u=u.subarray(0,c)),u};var U=255,E=2,L=8,C=16;function O(t,i){switch(this.p=[],this.q=32768,this.e=this.j=this.c=this.u=0,this.input=a?new Uint8Array(t):t,this.w=!1,this.r=B,this.L=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.q=i.bufferSize),i.bufferType&&(this.r=i.bufferType),i.resize&&(this.L=i.resize)),this.r){case D:this.b=32768,this.a=new(a?Uint8Array:Array)(32768+this.q+258);break;case B:this.b=0,this.a=new(a?Uint8Array:Array)(this.q),this.f=this.T,this.B=this.Q,this.s=this.S;break;default:e(Error("invalid inflate mode"))}}r("Zlib.Gzip",M),r("Zlib.Gzip.prototype.compress",M.prototype.g);var D=0,B=1,z={N:D,M:B};O.prototype.h=function(){for(;!this.w;){var n=ne(this,3);switch(1&n&&(this.w=i),n>>>=1){case 0:var r=this.input,s=this.c,o=this.a,l=this.b,h=t,u=t,c=t,f=o.length,d=t;switch(this.e=this.j=0,(h=r[s++])===t&&e(Error("invalid uncompressed block header: LEN (first byte)")),u=h,(h=r[s++])===t&&e(Error("invalid uncompressed block header: LEN (second byte)")),u|=h<<8,(h=r[s++])===t&&e(Error("invalid uncompressed block header: NLEN (first byte)")),c=h,(h=r[s++])===t&&e(Error("invalid uncompressed block header: NLEN (second byte)")),u===~(c|=h<<8)&&e(Error("invalid uncompressed block header: length verify")),s+u>r.length&&e(Error("input buffer is broken")),this.r){case D:for(;l+u>o.length;){if(u-=d=f-l,a)o.set(r.subarray(s,s+d),l),l+=d,s+=d;else for(;d--;)o[l++]=r[s++];this.b=l,o=this.f(),l=this.b}break;case B:for(;l+u>o.length;)o=this.f({F:2});break;default:e(Error("invalid inflate mode"))}if(a)o.set(r.subarray(s,s+u),l),l+=u,s+=u;else for(;u--;)o[l++]=r[s++];this.c=s,this.b=l,this.a=o;break;case 1:this.s(ee,ie);break;case 2:ae(this);break;default:e(Error("unknown BTYPE: "+n))}}return this.B()};var R,j,$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=a?new Uint16Array($):$,H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],W=a?new Uint16Array(H):H,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],q=a?new Uint8Array(V):V,Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],G=a?new Uint16Array(Z):Z,X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],K=a?new Uint8Array(X):X,Q=new(a?Uint8Array:Array)(288);for(R=0,j=Q.length;R<j;++R)Q[R]=143>=R?8:255>=R?9:279>=R?7:8;var Y,J,ee=b(Q),te=new(a?Uint8Array:Array)(30);for(Y=0,J=te.length;Y<J;++Y)te[Y]=5;var ie=b(te);function ne(i,n){for(var r,a=i.j,s=i.e,o=i.input,l=i.c;s<n;)(r=o[l++])===t&&e(Error("input buffer is broken")),a|=r<<s,s+=8;return r=a&(1<<n)-1,i.j=a>>>n,i.e=s-n,i.c=l,r}function re(e,i){for(var n,r,a,s=e.j,o=e.e,l=e.input,h=e.c,u=i[0],c=i[1];o<c&&(n=l[h++])!==t;)s|=n<<o,o+=8;return a=(r=u[s&(1<<c)-1])>>>16,e.j=s>>a,e.e=o-a,e.c=h,65535&r}function ae(e){function t(e,t,i){var n,r,a,s;for(s=0;s<e;)switch(n=re(this,t),n){case 16:for(a=3+ne(this,2);a--;)i[s++]=r;break;case 17:for(a=3+ne(this,3);a--;)i[s++]=0;r=0;break;case 18:for(a=11+ne(this,7);a--;)i[s++]=0;r=0;break;default:r=i[s++]=n}return i}var i,n,r,s,o=ne(e,5)+257,l=ne(e,5)+1,h=ne(e,4)+4,u=new(a?Uint8Array:Array)(N.length);for(s=0;s<h;++s)u[N[s]]=ne(e,3);i=b(u),n=new(a?Uint8Array:Array)(o),r=new(a?Uint8Array:Array)(l),e.s(b(t.call(e,o,i,n)),b(t.call(e,l,i,r)))}function se(e){this.input=e,this.c=0,this.t=[],this.D=!1}function oe(e){if("string"==typeof e){var t,i,n=e.split("");for(t=0,i=n.length;t<i;t++)n[t]=(255&n[t].charCodeAt(0))>>>0;e=n}for(var r,a=1,s=0,o=e.length,l=0;0<o;){o-=r=1024<o?1024:o;do{s+=a+=e[l++]}while(--r);a%=65521,s%=65521}return(s<<16|a)>>>0}function le(t,i){var n,r;switch(this.input=t,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.Z=i.verify)),n=t[this.c++],r=t[this.c++],15&n){case he:this.method=he;break;default:e(Error("unsupported compression method"))}0!=((n<<8)+r)%31&&e(Error("invalid fcheck flag:"+((n<<8)+r)%31)),32&r&&e(Error("fdict flag is not supported")),this.K=new O(t,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}O.prototype.s=function(e,t){var i=this.a,n=this.b;this.C=e;for(var r,a,s,o,l=i.length-258;256!==(r=re(this,e));)if(256>r)n>=l&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(o=W[a=r-257],0<q[a]&&(o+=ne(this,q[a])),r=re(this,t),s=G[r],0<K[r]&&(s+=ne(this,K[r])),n>=l&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},O.prototype.S=function(e,t){var i=this.a,n=this.b;this.C=e;for(var r,a,s,o,l=i.length;256!==(r=re(this,e));)if(256>r)n>=l&&(l=(i=this.f()).length),i[n++]=r;else for(o=W[a=r-257],0<q[a]&&(o+=ne(this,q[a])),r=re(this,t),s=G[r],0<K[r]&&(s+=ne(this,K[r])),n+o>l&&(l=(i=this.f()).length);o--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},O.prototype.f=function(){var e,t,i=new(a?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(a)i.set(r.subarray(32768,i.length));else for(e=0,t=i.length;e<t;++e)i[e]=r[e+32768];if(this.p.push(i),this.u+=i.length,a)r.set(r.subarray(n,n+32768));else for(e=0;32768>e;++e)r[e]=r[n+e];return this.b=32768,r},O.prototype.T=function(e){var t,i,n,r=this.input.length/this.c+1|0,s=this.input,o=this.a;return e&&("number"==typeof e.F&&(r=e.F),"number"==typeof e.O&&(r+=e.O)),2>r?i=(n=(s.length-this.c)/this.C[2]/2*258|0)<o.length?o.length+n:o.length<<1:i=o.length*r,a?(t=new Uint8Array(i)).set(o):t=o,this.a=t},O.prototype.B=function(){var e,t,i,n,r,s=0,o=this.a,l=this.p,h=new(a?Uint8Array:Array)(this.u+(this.b-32768));if(0===l.length)return a?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(t=0,i=l.length;t<i;++t)for(n=0,r=(e=l[t]).length;n<r;++n)h[s++]=e[n];for(t=32768,i=this.b;t<i;++t)h[s++]=o[t];return this.p=[],this.buffer=h},O.prototype.Q=function(){var e,t=this.b;return a?this.L?(e=new Uint8Array(t)).set(this.a.subarray(0,t)):e=this.a.subarray(0,t):(this.a.length>t&&(this.a.length=t),e=this.a),this.buffer=e},se.prototype.W=function(){return this.D||this.h(),this.t.slice()},se.prototype.h=function(){for(var n=this.input.length;this.c<n;){var r,s,o=new g,l=t,h=t,u=t,c=t,f=t,p=t,v=t,y=this.input,b=this.c;switch(o.G=y[b++],o.H=y[b++],(31!==o.G||139!==o.H)&&e(Error("invalid file signature:"+o.G+","+o.H)),o.z=y[b++],o.z){case 8:break;default:e(Error("unknown compression method: "+o.z))}if(o.n=y[b++],s=y[b++]|y[b++]<<8|y[b++]<<16|y[b++]<<24,o.Y=new Date(1e3*s),o.ea=y[b++],o.da=y[b++],0<(4&o.n)&&(o.$=y[b++]|y[b++]<<8,b+=o.$),0<(o.n&L)){for(p=[],f=0;0<(c=y[b++]);)p[f++]=String.fromCharCode(c);o.name=p.join("")}if(0<(o.n&C)){for(p=[],f=0;0<(c=y[b++]);)p[f++]=String.fromCharCode(c);o.A=p.join("")}0<(o.n&E)&&(o.R=65535&d(y,0,b),o.R!==(y[b++]|y[b++]<<8)&&e(Error("invalid header crc16"))),l=y[y.length-4]|y[y.length-3]<<8|y[y.length-2]<<16|y[y.length-1]<<24,y.length-b-4-4<512*l&&(u=l),h=new O(y,{index:b,bufferSize:u}),o.data=r=h.h(),b=h.c,o.ba=v=(y[b++]|y[b++]<<8|y[b++]<<16|y[b++]<<24)>>>0,d(r,t,t)!==v&&e(Error("invalid CRC-32 checksum: 0x"+d(r,t,t).toString(16)+" / 0x"+v.toString(16))),o.ca=l=(y[b++]|y[b++]<<8|y[b++]<<16|y[b++]<<24)>>>0,(4294967295&r.length)!==l&&e(Error("invalid input size: "+(4294967295&r.length)+" / "+l)),this.t.push(o),this.c=b}this.D=i;var _,m,k,w=this.t,x=0,A=0;for(_=0,m=w.length;_<m;++_)A+=w[_].data.length;if(a)for(k=new Uint8Array(A),_=0;_<m;++_)k.set(w[_].data,x),x+=w[_].data.length;else{for(k=[],_=0;_<m;++_)k[_]=w[_].data;k=Array.prototype.concat.apply([],k)}return k},r("Zlib.Gunzip",se),r("Zlib.Gunzip.prototype.decompress",se.prototype.h),r("Zlib.Gunzip.prototype.getMembers",se.prototype.W),le.prototype.h=function(){var t,i=this.input;return t=this.K.h(),this.c=this.K.c,this.Z&&((i[this.c++]<<24|i[this.c++]<<16|i[this.c++]<<8|i[this.c++])>>>0!==oe(t)&&e(Error("invalid adler-32 checksum"))),t};var he=8;function ue(e,t){this.input=e,this.a=new(a?Uint8Array:Array)(32768),this.k=ce.o;var i,n={};for(i in!t&&(t={})||"number"!=typeof t.compressionType||(this.k=t.compressionType),t)n[i]=t[i];n.outputBuffer=this.a,this.J=new _(this.input,n)}var ce=w;function fe(e,t){var i,n,a,s;if(Object.keys)i=Object.keys(t);else for(n in i=[],a=0,t)i[a++]=n;for(a=0,s=i.length;a<s;++a)r(e+"."+(n=i[a]),t[n])}ue.prototype.g=function(){var t,i,n,r,s,o,l,h=0;switch(l=this.a,t=he){case he:i=Math.LOG2E*Math.log(32768)-8;break;default:e(Error("invalid compression method"))}switch(n=i<<4|t,l[h++]=n,t){case he:switch(this.k){case ce.NONE:s=0;break;case ce.v:s=1;break;case ce.o:s=2;break;default:e(Error("unsupported compression type"))}break;default:e(Error("invalid compression method"))}return r=s<<6|0,l[h++]=r|31-(256*n+r)%31,o=oe(this.input),this.J.b=h,h=(l=this.J.g()).length,a&&((l=new Uint8Array(l.buffer)).length<=h+4&&(this.a=new Uint8Array(l.length+4),this.a.set(l),l=this.a),l=l.subarray(0,h+4)),l[h++]=o>>24&255,l[h++]=o>>16&255,l[h++]=o>>8&255,l[h++]=255&o,l},r("Zlib.Inflate",le),r("Zlib.Inflate.prototype.decompress",le.prototype.h),fe("Zlib.Inflate.BufferType",{ADAPTIVE:z.M,BLOCK:z.N}),r("Zlib.Deflate",ue),r("Zlib.Deflate.compress",function(e,t){return new ue(e,t).g()}),r("Zlib.Deflate.prototype.compress",ue.prototype.g),fe("Zlib.Deflate.CompressionType",{NONE:ce.NONE,FIXED:ce.v,DYNAMIC:ce.o})}).call(this)},function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryParser=t.BWSource=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(0);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.Zlib||(e.Zlib=e);var s=function(){function e(t,i,n){a(this,e),this.path=t.url,this.contentLength=i,this.bufferSize=n||512e3,this.range={start:-1,size:-1},this.config=t}return n(e,[{key:"dataViewForRange",value:function(e,t){var i=this;return new Promise(function(n,a){var s,o;function l(e,t,i){var r=e.data.byteLength,a=t.start-e.range.start,s=i?new Uint8Array(e.data,a,r-a):new DataView(e.data,a,r-a);n(s)}i.data&&i.range.start<=e.start&&i.range.start+i.range.size>=e.start+e.size?l(i,e,t):(s=Math.max(i.bufferSize,e.size),o=i.contentLength>0&&e.start+s>i.contentLength?{start:e.start}:{start:e.start,size:s},r.igvxhr.loadArrayBuffer(i.path,Object.assign(i.config,{range:o})).then(function(n){i.data=n,i.range=o,l(i,e,t)}).catch(a))})}}]),e}(),o=function(){function t(e){a(this,t),this.reader=new l(e),this.bufferedReader=new s(e)}return n(t,[{key:"getFeatures",value:function(i,n,r,a,s){this.st=(new Date).getTime();var o=this;return new Promise(function(l,h){o.features&&a?l(o.features):o.reader.getZoomHeaders().then(function(a){var u,c=o.reader,f=o.bufferedReader,d=s.bpPerPixel,p=t.zoomLevelForScale(d,a);p&&"BigWig"===c.type?(u=p.indexOffset,o.decodeFunction=t.decodeZoomData):(u=c.header.fullIndexOffset,"BigWig"===c.type?o.decodeFunction=t.decodeWigData:o.decodeFunction=t.decodeBedData),c.loadRPTree(u).then(function(t){var a=o.reader.chromTree.dictionary[i];void 0===a?l(null):t.findLeafItemsOverlapping(a,n,r).then(function(t){var s=[];t&&0!=t.length||l([]),t.forEach(function(t){s.push(new Promise(function(s,l){var h=[];f.dataViewForRange({start:t.dataOffset,size:t.dataSize},!0).then(function(t){var l=new e.Zlib.Inflate(t).decompress();o.decodeFunction(new DataView(l.buffer),i,a,n,r,h),s(h)}).catch(l)}))}),Promise.all(s).then(function(e){var t=(new Date).getTime()-o.st;console.log(t);var i,n=e[0];if(e.length>1)for(i=1;i<e.length;i++)n=n.concat(e[i]);n.sort(function(e,t){return e.start-t.start}),o.features=n,l(n)}).catch(h)}).catch(h)}).catch(h)}).catch(h)})}},{key:"getDefaultRange",value:function(){return void 0!=this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0}}],[{key:"zoomLevelForScale",value:function(e,t){var i,n,r=null;for(i=0;i<t.length;i++)if((n=t[i]).reductionLevel>e){r=n;break}return null==r&&(r=t[t.length-1]),r&&r.reductionLevel<4*e?r:null}},{key:"decodeWigData",value:function(e,t,i,n,r,a){var s,o=new f(e),l=o.getInt(),h=o.getInt(),u=o.getInt(),c=o.getInt(),d=o.getInt(),p=o.getByte(),v=(o.getByte(),o.getUShort());if(l===i)for(;v-- >0;){switch(p){case 1:h=o.getInt(),u=o.getInt(),s=o.getFloat();break;case 2:h=o.getInt(),s=o.getFloat(),u=h+d;break;case 3:s=o.getFloat(),u=h+d,h+=c}if(h>=r)break;u>n&&Number.isFinite(s)&&a.push({chr:t,start:h,end:u,value:s})}}},{key:"decodeZoomData",value:function(e,t,i,n,r,a){for(var s,o,l,h,u,c=new f(e);c.remLength()>=32;)if(c.getInt()===i){if(s=c.getInt(),o=c.getInt(),l=c.getInt(),c.getFloat(),c.getFloat(),h=c.getFloat(),c.getFloat(),u=0==l?0:h/l,s>=r)break;o>n&&Number.isFinite(u)&&a.push({chr:t,start:s,end:o,value:u})}}},{key:"decodeBedData",value:function(e,t,i,n,r,a){for(var s,o,l,h,u,c,d,p,v,g,y,b=new f(e);b.remLength()>=13;)if(b.getInt()==i&&(s=b.getInt(),o=b.getInt(),l=b.getString(),u={chr:t,start:s,end:o},s<r&&o>=n&&(a.push(u),(h=l.split("\t")).length>0&&(u.name=h[0]),h.length>1&&(u.score=parseFloat(h[1])),h.length>2&&(u.strand=h[2]),h.length>3&&(u.cdStart=parseInt(h[3])),h.length>4&&(u.cdEnd=parseInt(h[4])),h.length>5&&"."!==h[5]&&"0"!==h[5]&&(u.color=igv.createColorString(h[5])),h.length>8))){c=parseInt(h[6]),d=h[7].split(","),p=h[8].split(","),v=[];for(var _=0;_<c;_++)y=(g=start+parseInt(p[_]))+parseInt(d[_]),v.push({start:g,end:y});u.exons=v}}}]),t}(),l=function(){function e(t){a(this,e),this.path=t.url,this.headPath=t.headURL||this.path,this.rpTreeCache={},this.config=t}return n(e,[{key:"getZoomHeaders",value:function(){var e=this;return new Promise(function(t,i){e.zoomLevelHeaders?t(e.zoomLevelHeaders):e.loadHeader().then(function(){t(e.zoomLevelHeaders)}).catch(function(e){i(e)})})}},{key:"loadHeader",value:function(){var e=this;return new Promise(function(t,i){r.igvxhr.loadArrayBuffer(e.path,Object.assign(e.config,{range:{start:0,size:64}})).then(function(n){if(n){e.littleEndian=!0;var r=new f(new DataView(n));if(2291137574===(a=r.getUInt()))e.type="BigWig";else if(2273964779==a)e.type="BigBed";else{var a;e.littleEndian=!1,r.littleEndian=!1,r.position=0,654085990===(a=r.getUInt())?e.type="BigWig":3958540679==a&&(e.type="BigBed")}e.header={},e.header.bwVersion=r.getUShort(),e.header.nZoomLevels=r.getUShort(),e.header.chromTreeOffset=r.getLong(),e.header.fullDataOffset=r.getLong(),e.header.fullIndexOffset=r.getLong(),e.header.fieldCount=r.getUShort(),e.header.definedFieldCount=r.getUShort(),e.header.autoSqlOffset=r.getLong(),e.header.totalSummaryOffset=r.getLong(),e.header.uncompressBuffSize=r.getInt(),e.header.reserved=r.getLong(),e.loadZoomHeadersAndChrTree().then(t).catch(i)}}).catch(function(e){i(e)})})}},{key:"loadZoomHeadersAndChrTree",value:function(){var e=this;return new Promise(function(t,i){var n={start:64,size:e.header.fullDataOffset-64+5};r.igvxhr.loadArrayBuffer(e.path,Object.assign(e.config,{range:n})).then(function(i){var n,r,a=e.header.nZoomLevels,s=new f(new DataView(i));for(e.zoomLevelHeaders=[],e.firstZoomDataOffset=Number.MAX_VALUE,n=0;n<a;n++)r=new h(a-n,s),e.firstZoomDataOffset=Math.min(r.dataOffset,e.firstZoomDataOffset),e.zoomLevelHeaders.push(r);e.header.autoSqlOffset>0&&(s.position=e.header.autoSqlOffset-64,e.autoSql=s.getString()),e.header.totalSummaryOffset>0&&(s.position=e.header.totalSummaryOffset-64,e.totalSummary=new p(s)),e.header.chromTreeOffset>0&&(s.position=e.header.chromTreeOffset-64,e.chromTree=new v(s,64)),s.position=e.header.fullDataOffset-64,e.dataCount=s.getInt(),t()}).catch(i)})}},{key:"loadRPTree",value:function(e){var t=this;return new Promise(function(i,n){var r=t.rpTreeCache[e];r?i(r):(r=new u(e,t.contentLength,t.config,t.littleEndian),t.rpTreeCache[e]=r,r.load().then(function(){i(r)}).catch(n))})}}]),e}(),h=function e(t,i){a(this,e),this.index=t,this.reductionLevel=i.getInt(),this.reserved=i.getInt(),this.dataOffset=i.getLong(),this.indexOffset=i.getLong()},u=function(){function e(t,i,n,r){a(this,e),this.config=n,this.filesize=i,this.fileOffset=t,this.path=n.url,this.littleEndian=r}return n(e,[{key:"load",value:function(){var e=this;return new Promise(function(t,i){var n=e.fileOffset+48,r=new s(e.config,e.filesize,512e3);e.readNode(n,r).then(function(i){e.rootNode=i,t(e)}).catch(i)})}},{key:"readNode",value:function(e,t){var i=this;return new Promise(function(n,r){t.dataViewForRange({start:e,size:4},!1).then(function(a){var s=new f(a,i.littleEndian),o=1===s.getByte(),l=(s.getByte(),s.getUShort()),h={start:e+=4,size:l*(o?32:24)};t.dataViewForRange(h,!1).then(function(e){var t,i=new Array(l),r=new f(e);if(o){for(t=0;t<l;t++){var a={isLeaf:!0,startChrom:r.getInt(),startBase:r.getInt(),endChrom:r.getInt(),endBase:r.getInt(),dataOffset:r.getLong(),dataSize:r.getLong()};i[t]=a}n(new c(i))}else{for(t=0;t<l;t++){a={isLeaf:!1,startChrom:r.getInt(),startBase:r.getInt(),endChrom:r.getInt(),endBase:r.getInt(),childOffset:r.getLong()};i[t]=a}n(new c(i))}}).catch(r)}).catch(r)})}},{key:"findLeafItemsOverlapping",value:function(t,i,n){var r=this;return new Promise(function(a,o){var l=[],h=new Set,u=new s(r.config,r.filesize,512e3);h.add(0),function s(c,f){if(e.overlaps(c,t,i,n)){var d=c.items;d.forEach(function(a){e.overlaps(a,t,i,n)&&(a.isLeaf?l.push(a):a.childNode?s(a.childNode):(h.add(a.childOffset),r.readNode(a.childOffset,u).then(function(e){a.childNode=e,s(e,a.childOffset)}).catch(o)))})}void 0!=f&&h.delete(f);0===h.size&&a(l)}(r.rootNode,0)})}}],[{key:"overlaps",value:function(e,t,i,n){return e?(t>e.startChrom||t==e.startChrom&&n>=e.startBase)&&(t<e.endChrom||t==e.endChrom&&i<e.endBase):(console.log("null item"),!1)}}]),e}(),c=function e(t){a(this,e),this.items=t;var i,n,r=Number.MAX_VALUE,s=0,o=Number.MAX_VALUE,l=0;for(i=0;i<t.length;i++)n=t[i],r=Math.min(r,n.startChrom),s=Math.max(s,n.endChrom),o=Math.min(o,n.startBase),l=Math.max(l,n.endBase);this.startChrom=r,this.endChrom=s,this.startBase=o,this.endBase=l},f=function(){function e(t,i){a(this,e),this.littleEndian=i||!0,this.position=0,this.view=t,this.length=t.byteLength}return n(e,[{key:"available",value:function(){return this.length-this.position}},{key:"remLength",value:function(){return this.length-this.position}},{key:"hasNext",value:function(){return this.position<this.length-1}},{key:"getByte",value:function(){var e=this.view.getUint8(this.position,this.littleEndian);return this.position++,e}},{key:"getShort",value:function(){var e=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,e}},{key:"getUShort",value:function(){var e=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,e}},{key:"getInt",value:function(){var e=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,e}},{key:"getUInt",value:function(){var e=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,e}},{key:"getLong",value:function(){var e=[];e[0]=this.view.getUint8(this.position),e[1]=this.view.getUint8(this.position+1),e[2]=this.view.getUint8(this.position+2),e[3]=this.view.getUint8(this.position+3),e[4]=this.view.getUint8(this.position+4),e[5]=this.view.getUint8(this.position+5),e[6]=this.view.getUint8(this.position+6),e[7]=this.view.getUint8(this.position+7);var t=0;if(this.littleEndian)for(var i=e.length-1;i>=0;i--)t=256*t+e[i];else for(i=0;i<e.length;i++)t=256*t+e[i];return this.position+=8,t}},{key:"getString",value:function(e){for(var t,i="";0!=(t=this.view.getUint8(this.position++))&&(i+=String.fromCharCode(t),!e||i.length!=e););return i}},{key:"getFixedLengthString",value:function(e){var t,i,n="";for(t=0;t<e;t++)(i=this.view.getUint8(this.position++))>0&&(n+=String.fromCharCode(i));return n}},{key:"getFixedLengthTrimmedString",value:function(e){var t,i,n="";for(t=0;t<e;t++)(i=this.view.getUint8(this.position++))>32&&(n+=String.fromCharCode(i));return n}},{key:"getFloat",value:function(){var e=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,e}},{key:"getDouble",value:function(){var e=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,e}},{key:"skip",value:function(e){return this.position+=e,this.position}},{key:"getVPointer",value:function(){var e=this.position,t=this.view.getUint8(e+1)<<8|this.view.getUint8(e),i=4294967296*(255&this.view.getUint8(e+6))+16777216*(255&this.view.getUint8(e+5))+65536*(255&this.view.getUint8(e+4))+256*(255&this.view.getUint8(e+3))+(255&this.view.getUint8(e+2));return this.position+=8,new d(i,t)}}]),e}(),d=function(){function e(t,i){a(this,e),this.block=t,this.offset=i}return n(e,[{key:"isLessThan",value:function(e){return this.block<e.block||this.block===e.block&&this.offset<e.offset}},{key:"isGreaterThan",value:function(e){return this.block>e.block||this.block===e.block&&this.offset>e.offset}},{key:"print",value:function(){return this.block+":"+this.offset}}]),e}(),p=function(){function e(t){a(this,e),t?(this.basesCovered=t.getLong(),this.minVal=t.getDouble(),this.maxVal=t.getDouble(),this.sumData=t.getDouble(),this.sumSquares=t.getDouble(),this.computeStats()):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}return n(e,[{key:"computeStats",value:function(){var e=this.basesCovered;if(e>0){this.mean=this.sumData/e,this.stddev=Math.sqrt(this.sumSquares/(e-1));this.minVal<0&&(this.mean,this.stddev),this.maxVal>0&&(this.mean,this.stddev);this.defaultRange={min:0,max:this.mean+3*this.stddev}}}},{key:"updateStats",value:function(e){this.basesCovered+=e.count,this.sumData+=status.sumData,this.sumSquares+=sumSquares,this.minVal=MIN(_minVal,min),this.maxVal=MAX(_maxVal,max),computeStats.call(this)}}]),e}(),v=function e(t,i){a(this,e);var n=null;this.header={},this.header.magic=t.getInt(),this.header.blockSize=t.getInt(),this.header.keySize=t.getInt(),this.header.valSize=t.getInt(),this.header.itemCount=t.getLong(),this.header.reserved=t.getLong(),this.dictionary={},function e(t,r,a,s){r>=0&&(t.position=r);var o,l,h,u,c,f,d=t.getByte(),p=(t.getByte(),t.getUShort());if(1==d)for(o=0;o<p;o++)l=t.getFixedLengthTrimmedString(a),h=t.getInt(),t.getInt(),n&&(l=n.getChromosomeName(l)),s[l]=h;else for(o=0;o<p;o++)l=t.getFixedLengthTrimmedString(a),u=t.getLong(),c=u-i,f=t.position,e(t,c,a,s),t.position=f}(t,-1,this.header.keySize,this.dictionary);this.header.keySize};t.BWSource=o,t.BinaryParser=f}).call(this,i(1))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MLVBigBedTrack=t.RulerTrack=t.MLVBedTrack=t.MLVWigTrack=t.MLVTrack=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(2),a=i(5);function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function(){function e(t){l(this,e),this.config=t}return n(e,[{key:"_setFeatureSource",value:function(){}},{key:"getConfig",value:function(){return jQuery.extend(!0,{},this.config)}},{key:"setConfigAttribute",value:function(e,t){this.config[e]=t,"url"===e&&this._setFeatureSource()}},{key:"getFeatureAt",value:function(e,t,i,n){return null}},{key:"setConfig",value:function(e){this.config.url!==e.url?(this.config=e,this._setFeatureSource()):this._setFeatureSource()}},{key:"getFeatures",value:function(e,t,i,n,r){return this.feature_source.getFeatures(e,t,i,n,r)}}],[{key:"calculateLabel",value:function(e){var t=e.split("/"),i=t[t.length-1];return i=(t=i.split("."))[0]}},{key:"parseConfig",value:function(t){var i=$.extend(!0,{},t);return i.type&&i.format||!i.url||(i.url.endsWith("bw")&&(i.type="bigwig",i.format="wig"),i.url.endsWith(".bed.gz")&&(i.type="bed",i.format="feature"),i.url.endsWith(".bb")&&(i.type="bigbed",i.format="feature"),i.url.endsWith(".fasta")&&(i.type="fasta",i.format="sequence")),!i.short_label&&i.url&&(i.short_label=e.calculateLabel(i.url)),i.track_id||(i.track_id=i.url),"feature"===i.format&&(i.displayMode=i.displayMode||"COLLAPSED",i.labelDisplayMode="SLANT",i.squishedCallHeight=i.squishedCallHeight||30,i.expandedCallHeight=i.expandedCallHeight||15,i.featureHeight=i.featureHeight||12),"wig"===i.format&&(i.scale||(i.scale="automatic"),i.min_y||(i.min_y=0),i.maxy_y||(i.max_y=100)),i.color||(i.color="black"),i.opacity||(i.opacity=1),i}},{key:"getTrack",value:function(t){if("bigwig"===(t=e.parseConfig(t)).type)return new p(t);if("bed"===t.type)return new f(t);if("ucsc"===t.type)return new UCSCTrack(t);if("line"===t.type)return new v(t);if("bigbed"===t.type)return new d(t);if("ruler"===t.type)return new u(t);if("fasta"===t.type)return new g(t);var i=e.custom_tracks[t.type];return i?new i(t):void 0}}]),e}();h.custom_tracks={};var u=function(e){function t(e){l(this,t),e||(e={track_id:"ruler"+t.count,format:"ruler",short_label:"Ruler"});var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.height=30,i.name="",i.disableButtons=!0,i.ignoreTrackMenu=!0,i.order=-Number.MAX_VALUE,t.count++,i}return o(t,h),n(t,[{key:"getFeatures",value:function(e,t,i){return new Promise(function(e,t){e([])})}},{key:"drawFeatures",value:function(e){var i,n,r,a,s,o,l=e.context;i={textAlign:"center",font:"10px PT Sans",fillStyle:"rgba(64, 64, 64, 1)",strokeStyle:"rgba(64, 64, 64, 1)"},n=Math.floor(1100*e.bpPerPixel),a=(r=t.findSpacing(n)).majorTick,s=Math.floor(e.bpStart/a)-1,o=0;var h=e.top+this.height;for(y.setProperties(l,i);o<e.pixelWidth;){var u=Math.floor(s*a),c=2;o=Math.round((u-1-e.bpStart+.5)/e.bpPerPixel);var f=d(u/r.unitMultiplier,0)+" "+r.majorUnit;s%1==0&&y.fillText(l,f,o,h-15),y.strokeLine(l,o,h-10,o,h-c),s++}function d(e,t){var i=10;switch(t){case 0:i=1;break;case 1:i=10;break;case 2:i=100;break;default:i=1e3}var n=""+Math.abs(Math.round(e*i)/i);-1==n.indexOf(".")&&(n+=".");for(var r=n.substr(0,n.indexOf(".")),a=r-0,s=n.substr(n.indexOf("."));s.length-1<t;)s+="0";if("."==s&&(s=""),a>=1e3){var o=r.length;r=parseInt(""+a/1e3)+","+r.substring(o-3,o)}a>=1e6&&(o=r.length,r=parseInt(""+a/1e6)+","+r.substring(o-7,o));var l=r+s;return e<0&&(l="("+l+")"),l}return y.strokeLine(l,0,h-c,e.pixelWidth,h-c),h}}],[{key:"findSpacing",value:function(e){if(e<10)return new c(1,"",1);var t,i,n=Math.floor((t=e,i=Math.log(10),Math.log(t)/i)),r="",a=1;n>9&&(r="gb",a=1e9),n>6?(r="mb",a=1e6):n>3&&(r="kb",a=1e3);var s=e/Math.pow(10,n-1);return new c(s<25?Math.pow(10,n-1):Math.pow(10,n)/2,r,a)}}]),t}();u.count=0;var c=function e(t,i,n){l(this,e),this.majorTick=t,this.majorUnit=i,this.unitMultiplier=n},f=function(e){function t(e){l(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._setFeatureSource(),i.filter_function=null,i.color_function=null,i}return o(t,h),n(t,[{key:"_setFeatureSource",value:function(){this.feature_source=new a.FeatureSource(this.config)}},{key:"setFilterFunction",value:function(e){this.filter_function=e}},{key:"setColorFunction",value:function(e){this.color_function=e}},{key:"drawFeatures",value:function(e){var t,i=0,n=e.features,r=e.context,a=e.bpPerPixel,s=e.bpStart,o=e.pixelWidth,l=(e.pixelHeight,s+o*a+1),h=0;e.top&&(h=e.top),this.top=h;var u=this.config,c=0+o;if(this.config.squishedCallHeight=this.config.featureHeight+10,this.config.expandedCallHeight=this.config.featureHeight/2+2,n){var f=this.config.opacity?this.config.opacity:1;r.globalAlpha=f;for(var d,p=0,v=n.length;p<v;p++)if(d=n[p],!this.filter_function||this.filter_function(d)){if(d.display=!0,!(d.end<s)){if(d.start>l)break;var g=this.calculateFeatureCoordinates(d,s,a),y=u.featureHeight;"SQUISHED"===u.displayMode&&void 0!=d.row?(y=u.featureHeight/2,t=u.expandedCallHeight*d.row+2):t="EXPANDED"===u.displayMode&&void 0!=d.row?u.squishedCallHeight*d.row+5:5,(t+=h)+y>i&&(i=t+y),g.py=t,g.h=y;var b={bpPerPixel:a,bpStart:s,pixelWidth:o};this.color_function&&(d.color=this.color_function(d)),this.renderFeature(d,g,r,b),this.renderFeatureLabel(r,d,g.px,g.px1,t,0,c)}}else d._display=!1;r.globalAlpha=1}else console.log("No feature list");return this.bottom=i,"COLLAPSED"===this.config.displayMode&&(i+=25),i}},{key:"renderFeatureLabel",value:function(e,t,i,n,r,a,s){var o,l,h,u,c,f,d=this.config;n<a||i>s?(h=i,u=n):(h=Math.max(i,a),u=Math.min(n,s)),u-h>e.measureText(t.name).width&&"SQUISHED"!=d.displayMode&&void 0!==t.name&&(o={font:"10px PT Sans",textAlign:"center",fillStyle:d.color,strokeStyle:d.color},"COLLAPSED"===d.displayMode&&"SLANT"===d.labelDisplayMode&&(l={rotate:{angle:45}},delete o.textAlign),c=h+(u-h)/2,f=function(e,t){return t?e+d.featureHeight+14:e+d.featureHeight+7}(r,l),y.fillText(e,t.name,c,f,o,l))}},{key:"calculateFeatureCoordinates",value:function(e,t,i){var n=Math.round((e.start-t)/i),r=Math.round((e.end-t)/i),a=r-n;return a<3&&(a=3,n-=1),{px:n,px1:r,pw:a}}},{key:"renderFeature",value:function(e,t,i,n){var r,a,s,o,l,h,u,c,f,d,p,v=this.config.color;e.color&&(v=e.color),i.fillStyle=v,i.strokeStyle=v,d=(s=t.py+t.h/2)-(p=t.h/2)/2;var g=e.exons?e.exons.length:0;if(0==g)i.fillRect(t.px,t.py,t.pw,t.h);else{for(t.px=Math.max(t.px,0),t.px1=Math.min(t.px1,n.pixelWidth),y.strokeLine(i,t.px+1,s,t.px1-1,s),o="+"==e.strand?1:-1,a=t.px+10;a<t.px1;a+=20)y.strokeLine(i,a-2*o,s-2,a,s),y.strokeLine(i,a-2*o,s+2,a,s);for(r=0;r<g;r++)if(l=e.exons[r],h=Math.round((l.start-n.bpStart)/n.bpPerPixel),u=Math.round((l.end-n.bpStart)/n.bpPerPixel),f=Math.max(1,u-h),l.utr)i.fillRect(h,d,f,p);else if(l.cdStart&&(c=Math.round((l.cdStart-n.bpStart)/n.bpPerPixel),i.fillRect(h,d,c-h,p),f-=c-h,h=c),l.cdEnd&&(c=Math.round((l.cdEnd-n.bpStart)/n.bpPerPixel),i.fillRect(c,d,u-c,p),f-=u-c,u=c),i.fillRect(h,t.py,f,t.h),f>25){for(i.fillStyle="white",i.strokeStyle="white",a=h+10;a<u;a+=20)y.strokeLine(i,a-2*o,s-2,a,s),y.strokeLine(i,a-2*o,s+2,a,s);i.fillStyle=v,i.strokeStyle=v}}}},{key:"getFeatureAt",value:function(e,t,i,n){if(i-=this.top,this.feature_source.featureCache){var r,a=2*n,s=this.feature_source.featureCache.queryFeatures(t,e-a,e+a);if("COLLAPSED"!=this.config.displayMode&&(r=Math.floor("SQUISHED"===this.config.displayMode?i/this.config.expandedCallHeight:i/this.config.squishedCallHeight)),s&&s.length>0){var o=!0,l=!1,h=void 0;try{for(var u,c=s[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var f=u.value;if(f.end>=e-a&&f.start<=e+a&&(void 0===r||void 0===f.row||r===f.row))return console.log(f.name),f}}catch(e){l=!0,h=e}finally{try{!o&&c.return&&c.return()}finally{if(l)throw h}}}}return null}}]),t}(),d=function(e){function t(e){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,f),n(t,[{key:"_setFeatureSource",value:function(){this.feature_source=new a.BigBedFeatureSource(this.config)}}]),t}(),p=function(e){function t(e){l(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._setFeatureSource(),i}return o(t,h),n(t,[{key:"_setFeatureSource",value:function(){this.feature_source=new r.BWSource(this.config)}},{key:"drawFeatures",value:function(e){var t=this,i=e.features,n=t.config.color,r=e.context,a=e.bpPerPixel,s=e.bpStart,o=e.pixelWidth,l=e.pixelHeight,h=this.config.discrete?e.top:0,u=s+o*a+1,c=void 0;if(this.config.discrete&&(l=this.config.group?e.height:this.config.height),n||(n="black"),window.prev_coords={x:0,y:0},i){if(t.scale_link_to){var f=t.scale_link_to.config;f&&(t.config.scale=f.scale,t.max_y=t.scale_link_to.max_y,t.min_y=t.scale_link_to.min_y)}else if(void 0===t.max_y&&"automatic"===t.config.scale||"dynamic"===t.config.scale){var d=function(e){var t=0,i=-Number.MAX_VALUE;return e.forEach(function(e){t=Math.min(t,e.value),i=Math.max(i,e.value)}),{min:t,max:i}}(i);t.min_y=d.min,t.max_y=d.max}else"fixed"===t.config.scale&&(t.min_y=t.config.min_y,t.max_y=t.config.max_y);c=t.max_y-t.min_y;if(r.globalAlpha=this.config.opacity?this.config.opacity:1,t.is_line){var p=(1-t.config.value/c)*l;y.strokeLine(r,0,p,o,p,{strokeStyle:t.config.color,lineWidth:t.config.width?t.config.width:1})}else i.forEach(function(e,i,o){var f,d,p,v,g,b,_;if(e.end<s)return;if(e.start>u)return;p=Math.floor((e.start-s)/a),_=Math.floor((e.end-s)/a),g=Math.max(0,_-p),m=t.min_y,k=t.max_y,m>0&&k<0||m<0&&k>0?e.value<0?(f=t.max_y/c,d=-e.value/c):(f=(t.max_y-e.value)/c,d=e.value/c):t.min_y<0?(f=0,d=-e.value/c):(f=1-(e.value-t.min_y)/c,d=(e.value+t.min_y)/c);var m,k;v=(v=f*l+h)<h?h:v,b=(b=d*l)>l?l:b,"line"===t.config.display?(prev_coords.x&&y.strokeLine(r,p,v,prev_coords.x,prev_coords.y,{strokeStyle:n,lineWidth:3}),prev_coords.x=p,prev_coords.y=v):y.fillRect(r,p,v,g,b,{fillStyle:n})});r.globalAlpha=1}if(this.top=h,this.bottom=h+l,this.config.discrete)return this.bottom;this.top=0,this.bottom=0}}]),t}(),v=function(e){function t(e){l(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.is_line=!0,i}return o(t,p),n(t,[{key:"getFeatures",value:function(e,t,i){return new Promise(function(e,t){e([])})}}]),t}(),g=function(e){function t(e){l(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._setFeatureSource(e),i.sequenceType=e.sequenceType||"dna",i.height=15,i}return o(t,h),n(t,[{key:"_setFeatureSource",value:function(e){this.feature_source=new a.FastaSequence(e.url)}},{key:"getFeatures",value:function(e,t,i,n,r){var a=this;return new Promise(function(n,s){r.bpPerPixel>1?n(null):a.feature_source.getSequence(e,t,i).then(n).catch(s)})}},{key:"drawFeatures",value:function(e){var t,i,n,r,a,s,o,l,h,u,c=e.features,f=e.context,d=e.bpPerPixel,p=e.bpStart,v=p+e.pixelWidth*d+1,g=e.top;if(c)for(t=c.length,i=1/d,n=g+this.height/2,r=p;r<=v;r++)(a=r-p)<t&&(s=c[a],o=Math.floor(a*i),l=Math.floor((a+1)*i),h=Math.round((o+l)/2),(u=this.color?this.color:"dna"===this.sequenceType?y.nucleotideColors[s]:"rgb(0, 0, 150)")||(u="gray"),d>.15?y.fillRect(f,o,g,l-o,10,{fillStyle:u}):y.strokeText(f,s,h,n,{strokeStyle:u,font:"normal 10px Arial",textAlign:"center"}));return g+10}}]),t}(),y=function(){function e(){l(this,e)}return n(e,null,[{key:"setProperties",value:function(e,t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];e[i]=n}}},{key:"strokeLine",value:function(t,i,n,r,a,s){i=Math.floor(i)+.5,n=Math.floor(n)+.5,r=Math.floor(r)+.5,a=Math.floor(a)+.5,t.save(),s&&e.setProperties(t,s),t.beginPath(),t.moveTo(i,n),t.lineTo(r,a),t.stroke(),t.restore()}},{key:"fillRect",value:function(t,i,n,r,a,s){i=Math.round(i),n=Math.round(n),s&&(t.save(),e.setProperties(t,s)),t.fillRect(i,n,r,a),s&&t.restore()}},{key:"fillPolygon",value:function(t,i,n,r){t.save(),r&&e.setProperties(t,r),doPath(t,i,n),t.fill(),t.restore()}},{key:"strokePolygon",value:function(t,i,n,r){t.save(),r&&e.setProperties(t,r),doPath(t,i,n),t.stroke(),t.restore()}},{key:"fillText",value:function(t,i,n,r,a,s){if(a&&(t.save(),e.setProperties(t,a)),t.save(),t.translate(n,r),s)for(var o in s){var l=s[o];"translate"==o&&t.translate(l.x,l.y),"rotate"==o&&t.rotate(l.angle*Math.PI/180)}t.fillText(i,0,0),t.restore(),a&&t.restore()}},{key:"strokeText",value:function(t,i,n,r,a,s){if(t.save(),a&&e.setProperties(t,a),t.translate(n,r),s)for(var o in s){var l=s[o];"translate"==o&&t.translate(l.x,l.y),"rotate"==o&&t.rotate(l.angle*Math.PI/180)}t.strokeText(i,0,0),t.restore()}},{key:"strokeCircle",value:function(e,t,i,n){e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.stroke()}},{key:"fillCircle",value:function(e,t,i,n){e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.fill()}},{key:"drawArrowhead",value:function(e,t,i,n,r){e.save(),n||(n=5),r&&(e.lineWidth=r),e.beginPath(),e.moveTo(t,i-n/2),e.lineTo(t,i+n/2),e.lineTo(t+n,i),e.lineTo(t,i-n/2),e.closePath(),e.fill(),e.restore()}},{key:"dashedLine",value:function(t,i,n,r,a,s,o){t.save(),i=Math.round(i),n=Math.round(n),r=Math.round(r),a=Math.round(a),s=Math.round(s),log("dashedLine"),o&&e.setProperties(t,o),void 0==s&&(s=2),t.moveTo(i,n);for(var l=r-i,h=a-n,u=Math.floor(Math.sqrt(l*l+h*h)/s),c=l/u,f=h/u,d=0;d++<u;)i+=c,n+=f,t[d%2==0?"moveTo":"lineTo"](i,n);t[d%2==0?"moveTo":"lineTo"](r,a),t.restore()}},{key:"doPath",value:function(e,t,i){var n,r=t.length;for(n=0;n<r;n++)t[n]=Math.round(t[n]),i[n]=Math.round(i[n]);for(e.beginPath(),e.moveTo(t[0],i[0]),n=1;n<r;n++)e.lineTo(t[n],i[n]);e.closePath()}}]),e}();y.nucleotideColors={A:"green",T:"red",G:"black",C:"blue",a:"green",t:"red",c:"black",g:"blue"},t.MLVTrack=h,t.MLVWigTrack=p,t.MLVBedTrack=f,t.RulerTrack=u,t.MLVBigBedTrack=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var r={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"spinner",value:function(e){var t;return t=$('<i class="fa fa-lg fa-spinner fa-spin igv-spinner">').css({position:"absolute",top:"50%",left:"50%"}),e&&t.css("font-size",e),t[0]}},{key:"getSpinnerObjectWithParentElement",value:function(e){return e.find("div.igv-spinner-container")}},{key:"startSpinnerAtParentElement",value:function(e){e.children(".fa-spinner").show()}},{key:"stopSpinnerAtParentElement",value:function(e){e.children(".fa-spinner").hide()}},{key:"parseUri",value:function(e){for(var t=r,i=t.parser[t.strictMode?"strict":"loose"].exec(e),n={},a=14;a--;)n[t.key[a]]=i[a]||"";return n[t.q.name]={},n[t.key[12]].replace(t.q.parser,function(e,i,r){i&&(n[t.q.name][i]=r)}),n}},{key:"domElementRectAsString",value:function(e){return" x "+e.clientLeft+" y "+e.clientTop+" w "+e.clientWidth+" h "+e.clientHeight}},{key:"isNumber",value:function(e){return""!==e&&(void 0!==e&&(!isNaN(parseFloat(e))&&isFinite(e)))}},{key:"guid",value:function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}},{key:"random",value:function(e,t){return Math.random()*(t-e)+e}},{key:"numberFormatter",value:function(e){var t=String(e).split(/[.,]/);return t[0].split("").reverse().reduce(function(e,t,i){return i%3==0?e+","+t:e+t}).split("").reverse().join("")+(t[1]?"."+t[1]:"")}},{key:"numberUnFormatter",value:function(e){return e.split(",").join().replace(",","","g")}},{key:"translateMouseCoordinates",value:function(e,t){var i=$.event.fix(e);return{x:i.pageX-$(t).offset().left,y:i.pageY-$(t).offset().top}}},{key:"formatPopoverText",value:function(e){var t='<table class="igv-popover-table">';return e.forEach(function(e){e.name?t+='<tr><td class="igv-popover-td"><div class="igv-popoverNameValue"><span class="igv-popoverName">'+e.name+'</span><span class="igv-popoverValue">'+e.value+"</span></div></td></tr>":t+="<tr><td>"+e.toString()+"</td></tr>"}),t+="</table>"}},{key:"throttle",value:function(e,t,i){var n,r;return t||(t=200),function(){var a=i||this,s=+new Date,o=arguments;n&&s<n+t?(clearTimeout(r),r=setTimeout(function(){n=s,e.apply(a,o)},t)):(n=s,e.apply(a,o))}}},{key:"splitStringRespectingQuotes",value:function(e,t){var i,n,r=[],a=e.length,s=0,o=!1;if(a>0)for(r[s]=e.charAt(0),i=1;i<a;i++)'"'===(n=e.charAt(i))?o=!o:o||n!==t?r[s]+=n:r[++s]="";return r}},{key:"addAjaxExtensions",value:function(){$.ajaxTransport("+binary",function(e,t,i){return{send:function(t,i){var n=new XMLHttpRequest,r=e.url,a=e.type;e.data;if(n.addEventListener("load",function(){var t={};t[e.dataType]=n.response,i(n.status,n.statusText,t,n.getAllResponseHeaders())}),n.open(a,r),n.responseType="arraybuffer",e.headers)for(var s in e.headers)e.headers.hasOwnProperty(s)&&n.setRequestHeader(s,e.headers[s])},abort:function(){i.abort()}}})}},{key:"isStringOrNumber",value:function(e){return!(!e.substring&&!e.toFixed)}},{key:"constrainBBox",value:function(e,t){var i,n,r={},a={};return a.left=a.top=0,a.right=t.outerWidth(),a.bottom=t.outerHeight(),n=e.offset(),r.left=n.left-t.offset().left,r.top=n.top-t.offset().top,r.right=r.left+e.outerWidth(),r.bottom=r.top+e.outerHeight(),(i=r.bottom-a.bottom)>0&&(n.top-=i,r.top-=i,r.bottom-=i,(i=r.top-a.top)<0&&(n.top-=i)),n}},{key:"log",value:function(e){igv.enableLogging&&console&&console.log&&console.log(e)}}]),e}();t.Utils=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BigBedFeatureSource=t.FastaSequence=t.FeatureSource=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(4),a=i(0),s=i(10),o=i(2);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function(){function e(t){l(this,e),this.config=t||{},this.sourceType=void 0===t.sourceType?"file":t.sourceType,"ga4gh"===t.sourceType?this.reader=new igv.Ga4ghVariantReader(t):"immvar"===t.sourceType?this.reader=new igv.ImmVarReader(t):"eqtl"===t.type?"gtex-ws"===t.sourceType?this.reader=new igv.GtexReader(t):this.reader=new igv.GtexFileReader(t):"bigquery"===t.sourceType?this.reader=new igv.BigQueryFeatureReader(t):this.reader=new c(t),this.visibilityWindow=t.visibilityWindow}return n(e,[{key:"getFileHeader",value:function(){var e=this,t=this.config.maxRows||500;return new Promise(function(i,n){e.header?i(e.header):"function"==typeof e.reader.readHeader?e.reader.readHeader().then(function(n){if(e.is_indexed=!0,n){var r=n.features;r&&("gtf"!==e.config.format&&"gff3"!==e.config.format&&"gff"!==e.config.format||(r=new igv.GFFHelper(e.config.format).combineFeatures(r)),packFeatures(r,t),e.featureCache=new v(r),e.config.searchable&&e.addFeaturesToDB(r))}n&&n.format&&(e.config.format=n.format),i(n)}).catch(n):i(null)})}},{key:"getFeatures",value:function(e,t,i,n,r){if(this.is_indexed)return this._getFeatures(e,t,i,n,r);var a=this;return new Promise(function(s,o){a.getFileHeader().then(function(){a._getFeatures(e,t,i,n,r).then(function(e){console.log(i),s(e)})})})}},{key:"_getFeatures",value:function(t,i,n,r,a){var s=this;return s.time=Date.now(),new Promise(function(o,l){var h=new m(t,i,n),u=s.featureCache,c=s.config.maxRows||500;u&&(void 0===u.range||u.range.containsRange(h))?o(s.featureCache.queryFeatures(t,i,n)):s.retrieveFeatures(t,h.start,h.end,r,a).then(function(r){if(r&&"function"==typeof r.forEach){var a=s.reader.indexed||"ga4gh"===s.config.sourceType||"immvar"===s.config.sourceType||"gtex"===s.config.sourceType||"bigquery"===s.config.sourceType||"custom"===s.config.sourceType;"gtf"!==s.config.format&&"gff3"!==s.config.format&&"gff"!==s.config.format||(r=new igv.GFFHelper(s.config.format).combineFeatures(r)),s.featureCache=a?new v(r,h):new v(r),e.packFeatures(r,c),s.config.searchable&&addFeaturesToDB(r),o(s.featureCache.queryFeatures(t,i,n))}else o(null)}).catch(l)})}},{key:"retrieveFeatures",value:function(e,t,i){return this.reader.readFeatures(e,t,i)}}],[{key:"addFeaturesToDB",value:function(e){e.forEach(function(e){e.name&&(igv.browser.featureDB[e.name.toUpperCase()]=e)})}},{key:"packFeatures",value:function(e,t){if(null!=e&&0!==e.length){var i={},n=[];e.forEach(function(e){var t=e.chr,r=i[t];r||(r=[],i[t]=r,n.push(t)),r.push(e)}),n.forEach(function(e){!function(e,t){var i=[];e.sort(function(e,t){return e.start-t.start}),i.push(-1e3),e.forEach(function(e){var n,r=Math.min(i.length,t),a=e.start;for(n=0;n<r;n++)if(a>=i[n])return e.row=n,void(i[n]=e.end);e.row=n,i[n]=e.end})}(i[e],t)})}}}]),e}(),u=function(e){function t(e){l(this,t),e.sourceType="gtex";var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.header=!0,i.feature_source=new o.BWSource(e),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,h),n(t,[{key:"retrieveFeatures",value:function(e,t,i,n,r){return this.feature_source.getFeatures(e,t,i,!1,r)}}]),t}(),c=function(){function e(t){if(l(this,e),this.config=t||{},t.localFile)this.localFile=t.localFile,this.filename=t.localFile.name;else{this.url=t.url,this.indexURL=t.indexURL,this.headURL=t.headURL||this.filename;var i=r.Utils.parseUri(t.url);this.filename=i.file,this.path=i.path}this.format=t.format,this.parser=this.getParser(this.format,t.decode)}return n(e,[{key:"getParser",value:function(e,t){switch(e){case"vcf":return new VcfParser;case"seg":return new SegParser;default:return new p(e,t,this.config)}}},{key:"isIndexable",value:function(){var e=this.config.indexURL,t=this.type,i=this.config.indexed;return e||"wig"!=t&&0!=i}},{key:"loadIndex",value:function(){var e=this.indexURL;return this.filename.endsWith(".gz")?(e||(e=this.url+".tbi"),(0,s.loadBamIndex)(e,this.config,!0)):(e||(e=this.url+".idx"),loadTribbleIndex(e,this.config))}},{key:"loadFeaturesNoIndex",value:function(){var e=this;return new Promise(function(t,i){var n=e.parser,r={headers:e.config.headers,withCredentials:e.config.withCredentials};function s(i){e.header=n.parseHeader(i),e.header instanceof String&&e.header.startsWith("##gff-version 3")&&(e.format="gff3"),t(n.parseFeatures(i))}e.localFile?a.igvxhr.loadStringFromFile(e.localFile,r).then(s).catch(i):a.igvxhr.loadString(e.url,r).then(s).catch(i)})}},{key:"loadFeaturesWithIndex",value:function(e,t,i){var n=this;return new Promise(function(r,s){var o,l=n.index,h=l&&l.tabix?l.sequenceIndexMap[e]:e,u=[];(o=l.blocksForRange(h,t,i))&&0!==o.length?(o.forEach(function(e){u.push(new Promise(function(t,i){var r,s=e.minv.block,o=e.minv.offset,h=e.maxv.block+(l.tabix?65536:0),u={headers:n.config.headers,range:{start:s,size:h-s+1},withCredentials:n.config.withCredentials};r=function(e){var i,r;i=l.tabix?a.igvxhr.arrayBufferToString((0,a.unbgzf)(e)):e,r=o?i.slice(o):i;var s=n.parser.parseFeatures(r);t(s)},n.localFile?a.igvxhr.loadStringFromFile(n.localFile,u).then(r).catch(i):l.tabix?a.igvxhr.loadArrayBuffer(n.url,u).then(r).catch(i):a.igvxhr.loadString(n.url,u).then(r).catch(i)}))}),Promise.all(u).then(function(e){var t,i;if(1===e.length)i=e[0];else{for(i=e[0],t=1;t<e.length;t++)i=i.concat(e[t]);i.sort(function(e,t){return e.start-t.start})}r(i)}).catch(s)):r(null)})}},{key:"getIndex",value:function(){var e=this,t=this.isIndexable();return new Promise(function(i,n){void 0===e.indexed&&t?e.loadIndex().then(function(t){t?(e.index=t,e.indexed=!0):e.indexed=!1,i(e.index)}):i(e.index)})}},{key:"readHeader",value:function(){var e=this;return new Promise(function(t,i){e.header?t(e.header):e.getIndex().then(function(n){if(n){var r={headers:e.config.headers,bgz:n.tabix,range:{start:0,size:65e3},withCredentials:e.config.withCredentials},s=function(i){e.header=e.parser.parseHeader(i),t(e.header)};e.localFile?a.igvxhr.loadStringFromFile(e.localFile,r).then(s):a.igvxhr.loadString(e.url,r).then(s).catch(i)}else e.loadFeaturesNoIndex(void 0).then(function(i){var n=e.header||{};n.features=i,t(n)}).catch(i)})})}},{key:"readFeatures",value:function(e,t,i){var n=this;return new Promise(function(r,a){function s(e){r(e)}n.index?n.loadFeaturesWithIndex(e,t,i).then(s):n.loadFeaturesNoIndex().then(s)})}}]),e}(),f=Number.MAX_VALUE,d=["Name","gene_name","gene","gene_id","alias","locus"],p=function(){function e(t,i,n){switch(l(this,e),this.format=t,this.nameField=n?n.nameField:void 0,this.skipRows=0,i&&(this.decode=i),t){case"narrowpeak":case"broadpeak":case"peaks":this.decode=this.decodePeak,this.delimiter=/\s+/;break;case"bedgraph":this.decode=this.decodeBedGraph,this.delimiter=/\s+/;break;case"wig":this.decode=this.decodeWig,this.delimiter=/\s+/;break;case"gff3":case"gff":case"gtf":this.decode=this.decodeGFF,this.delimiter="\t";break;case"aneu":this.decode=this.decodeAneu,this.delimiter="\t";break;case"fusionjuncspan":this.decode=this.decodeFusionJuncSpan,this.delimiter=/\s+/;break;case"gtexgwas":this.skipRows=1,this.decode=this.decodeGtexGWAS,this.delimiter="\t";break;case"refflat":this.decode=this.decodeRefflat,this.delimiter="\t";break;default:this.decode=e.decodeBed,this.delimiter=/\s+/}}return n(e,[{key:"parseHeader",value:function(e){var t,i,n,r=e.split("\n"),a=r.length;for(i=0;i<a;i++){if(!((t=r[i]).startsWith("track")||t.startsWith("#")||t.startsWith("browser"))){n={};break}t.startsWith("track")?n=this.parseTrackLine(t):t.startsWith("##gff-version 3")&&(this.format="gff3",n||(n={}),n.format="gff3")}return n}},{key:"parseFeatures",value:function(e){if(!e)return null;var t,i,n,r,a,s,o=e.split("\n"),l=o.length,h=[],u=0,c=(this.decode,this.format),d=this.delimiter||"\t";for(a=this.skipRows;a<l;a++)(r=o[a]).startsWith("track")||r.startsWith("#")||r.startsWith("browser")||("wig"===c&&r.startsWith("fixedStep")?t=this.parseFixedStep(r):"wig"===c&&r.startsWith("variableStep")?t=this.parseVariableStep(r):(n=o[a].split(d)).length<1||(i=this.decode(n,t))&&(h.length<f?h.push(i):(s=Math.floor(Math.random()*u))<f&&(h[s]=i),u++));return h}},{key:"decodeCustom",value:function(e,t){var i,n,r,a,s=this.format,o=s.coords||0;return e.length<3?null:(n=e[s.chr],r=parseInt(e[s.start])-o,a=void 0!==s.end?parseInt(e[s.end]):r+1,i={chr:n,start:r,end:a},s.fields&&s.fields.forEach(function(t,n){n!=s.chr&&n!=s.start&&n!=s.end&&(i[t]=e[n])}),i)}}],[{key:"parseFixedStep",value:function(e){var t=e.split(/\s+/);return{format:"fixedStep",chrom:t[1].split("=")[1],start:parseInt(t[2].split("=")[1],10),step:parseInt(t[3].split("=")[1],10),span:t.length>4?parseInt(t[4].split("=")[1],10):1,index:0}}},{key:"parseVariableStep",value:function(e){var t=e.split(/\s+/);return{format:"variableStep",chrom:t[1].split("=")[1],span:t.length>2?parseInt(t[2].split("=")[1],10):1}}},{key:"parseTrackLine",value:function(e){var t,i,n,r={},a=e.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),s=[];for(t=1;t<a.length;t++)a[t]&&0!==a[t].trim().length&&((i=a[t].trim()).endsWith("=")>0?n=i:n?(s.push(n+i),n=void 0):s.push(i));return s.forEach(function(e){if(e){var t=e.split("=",2);2==t.length&&(r[t[0]]=t[1])}}),r}},{key:"decodeBed",value:function(e,t){var i,n,r,a,s,o,l,h,u,c,f,d,p,v;if(e.length<3)return null;if(i=e[0],n=parseInt(e[1]),r=e.length>2?parseInt(e[2]):n+1,d={chr:i,start:n,end:r,score:1e3},e.length>3){l=(o=e[3].replace(/"/g,"")).split(";");for(var g=0;g<l.length;g++){var y=l[g].split("=");"gene_id"==y[0]&&(a=y[1]),"gene_name"==y[0]&&(s=y[1])}d.id=a||o,d.name=s||o}if(e.length>4&&(d.score=parseFloat(e[4])),e.length>5&&(d.strand=e[5]),e.length>6&&(d.cdStart=parseInt(e[6])),e.length>7&&(d.cdEnd=parseInt(e[7])),e.length>8&&"."!==e[8]&&"0"!==e[8]&&(d.color=igv.createColorString(e[8])),e.length>11){h=parseInt(e[9]),u=e[10].split(","),c=e[11].split(","),f=[];for(g=0;g<h;g++){var b={start:p=n+parseInt(c[g]),end:v=p+parseInt(u[g])};(d.cdStart>v||d.cdEnd<d.cdStart)&&(b.utr=!0),d.cdStart>=p&&d.cdStart<=v&&(b.cdStart=d.cdStart),d.cdEnd>=p&&d.cdEnd<=v&&(b.cdEnd=d.cdEnd),f.push(b)}d.exons=f}return d.popupData=function(){var e=[];return d.name&&e.push({name:"Name",value:d.name}),"+"!==d.strand&&"-"!==d.strand||e.push({name:"Strand",value:d.strand}),e},d}},{key:"decodeRefflat",value:function(e,t){if(e.length<10)return null;for(var i={chr:e[2],start:parseInt(e[4]),end:parseInt(e[5]),id:e[1],name:e[0],strand:e[3],cdStart:parseInt(e[6]),cdEnd:parseInt(e[7])},n=parseInt(e[8]),r=e[9].split(","),a=e[10].split(","),s=[],o=0;o<n;o++)s.push({start:parseInt(r[o]),end:parseInt(a[o])});return i.exons=s,i.popupData=function(){return[{name:"Name",value:i.name}]},i}},{key:"decodePeak",value:function(e,t){var i,n,r,a,s,o,l,h,u;return e.length<9?null:(i=e[0],n=parseInt(e[1]),r=parseInt(e[2]),s=e[3],o=parseFloat(e[4]),a=e[5].trim(),h=parseFloat(e[6]),u=parseFloat(e[7]),l=parseFloat(e[8]),0===o&&(o=h),{chr:i,start:n,end:r,name:s,score:o,strand:a,signal:h,pValue:u,qValue:l})}},{key:"decodeBedGraph",value:function(e,t){return e.length<3?null:{chr:e[0],start:parseInt(e[1]),end:parseInt(e[2]),value:parseFloat(e[3])}}},{key:"decodeWig",value:function(e,t){var i,n,r;return"fixedStep"===t.format?(n=(i=t.index*t.step+t.start)+t.span,r=parseFloat(e[0]),++t.index,isNaN(r)?null:{chr:t.chrom,start:i,end:n,value:r}):"variableStep"===t.format?e.length<2?null:(n=(i=parseInt(e[0],10))+t.span,r=parseFloat(e[1]),isNaN(r)?null:{chr:t.chrom,start:i,end:n,value:r}):decodeBedGraph(e)}},{key:"decodeAneu",value:function(e,t){var i,n,r,a;return e.length<4?null:(i=e[1],n=parseInt(e[2]),r=e.length>3?parseInt(e[3]):n+1,a={chr:i,start:n,end:r},e.length>4&&(a.score=parseFloat(e[4]),a.value=a.score),a.popupData=function(){return[{name:"Name",value:a.name}]},a)}},{key:"decodeFusionJuncSpan",value:function(e,t){var i=e[0],n=e[1],r=parseInt(e[2]),a=parseInt(e[3]),s=parseInt(e[4]),o=parseInt(e[5]),l=e[6],h={chr:i,name:n,junction_left:r,junction_right:a,num_junction_reads:s,num_spanning_frags:o,spanning_frag_coords:[],start:-1,end:-1},u=r,c=a;if(o>0)for(var f=l.split(","),d=0;d<f.length;d++){var p=f[d].split("-"),v=p[0],g=p[1];v<u&&(u=v),g>c&&(c=g),h.spanning_frag_coords.push({left:v,right:g})}return h.start=u,h.end=c,h.popupData=function(){return[{name:"Name",value:h.name}]},h}},{key:"decodeGtexGWAS",value:function(e,t){return e.length<8?null:{chr:e[0],start:parseInt(e[1])-1,end:parseInt(e[3].split(":")[1]),pvalue:parseFloat(e[5])}}},{key:"decodeGFF",value:function(e,t){var i,n,r,a,s,o,l,h,u,c,f,p,v=this.format;if(e.length<9)return null;i=e[0],s=e[2],n=parseInt(e[3])-1,r=parseInt(e[4]),o="."===e[5]?0:parseFloat(e[5]),a=e[6],"."===e[7]||parseInt(e[7]),l=e[8];var g="gff3"===v?"=":/\s+/,y={};if(l.split(";").forEach(function(e){var t,i,n=e.trim().split(g,2);2==n.length&&(t=n[0].trim(),(i=n[1].trim()).startsWith('"')&&i.endsWith('"')&&(i=i.substr(1,i.length-2)),"ID"===n[0]?h=n[1]:"Parent"===n[0]?u=n[1]:"color"===n[0].toLowerCase()?c=igv.createColorString(n[1]):"transcript_id"===n[0]&&(h=n[1]),y[t]=i)}),this.nameField)f=y[this.nameField];else for(p=0;p<d.length;p++)if(y.hasOwnProperty(d[p])){this.nameField=d[p],f=y[this.nameField];break}return{id:h,parent:u,name:f,type:s,chr:i,start:n,end:r,score:o,strand:a,color:c,attributeString:l,popupData:function(){var e,t,i=[];return this.attributeString.split(";").forEach(function(n){var r=n.trim().split(g,2);2===r.length&&void 0!==r[1]&&(e=r[0].trim(),(t=r[1].trim()).startsWith('"')&&t.endsWith('"')&&(t=t.substr(1,t.length-2)),i.push({name:e,value:t}))}),i}}}}]),e}(),v=function(){function e(t,i){l(this,e),this.treeMap=e.buildTreeMap(t),this.range=i}return n(e,[{key:"queryFeatures",value:function(e,t,i){var n,r,a,s,o,l,h;return(l=this.treeMap[e])?0==(h=l.findOverlapping(t,i)).length?[]:(n=[],h.forEach(function(e){for(r=e.value,s=r.length,o=0;o<s&&!((a=r[o]).start>i);o++)a.end>=t&&n.push(a)}),n):[]}},{key:"allFeatures",value:function(){var e=[],t=this.treeMap;if(t)for(var i in t){if(t.hasOwnProperty(i))t[i].mapIntervals(function(t){e=e.concat(t.value)})}return e}}],[{key:"buildTreeMap",value:function(t){var i={},n=[],r={};if(t){t.forEach(function(e){var t,r=e.chr;(t=i[r])||(n.push(r),t=[],i[r]=t),t.push(e)});for(var a=0;a<n.length;a++){var s=n[a];r[s]=e.buildIntervalTree(i[s])}}return r}},{key:"buildIntervalTree",value:function(e){var t,i,n,r,a,s,o,l;for(a=new y,o=e.length,s=Math.max(10,Math.round(o/100)),e.sort(function(e,t){return e.start===t.start?0:e.start>t.start?1:-1}),t=0;t<o;t+=s)i=Math.min(o,t+s),n=(l=e.slice(t,i))[0].start,r=n,l.forEach(function(e){r=Math.max(r,e.end)}),a.insert(n,r,l);return a}}]),e}(),g={color:1};g.parent=g,g.left=g,g.right=g;var y=function(){function e(){l(this,e),this.root=g}return n(e,[{key:"insert",value:function(e,t,i){var n=new b(e,t,i),r=new _(n);for(this.treeInsert(r),r.color=2;r!=this.root&&2==r.parent.color;){var a;if(r.parent==r.parent.parent.left)2==(a=r.parent.parent.right).color?(r.parent.color=1,a.color=1,r.parent.parent.color=2,r=r.parent.parent):(r==r.parent.right&&(r=r.parent,this.leftRotate(r)),r.parent.color=1,r.parent.parent.color=2,this.rightRotate(r.parent.parent));else 2==(a=r.parent.parent.left).color?(r.parent.color=1,a.color=1,r.parent.parent.color=2,r=r.parent.parent):(r==r.parent.left&&(r=r.parent,this.rightRotate(r)),r.parent.color=1,r.parent.parent.color=2,this.leftRotate(r.parent.parent))}this.root.color=1}},{key:"findOverlapping",value:function(e,t){var i=new b(e,t,0);if(this.root===g)return[];var n=this.searchAll(i,this.root,[]);return n.length>1&&n.sort(function(e,t){return e.low-t.low}),n}},{key:"logIntervals",value:function(){!function e(t,i){var n="";for(var r=0;r<i;r++)n+=" ";console.log(n+t.interval.low+" "+t.interval.high);i+=5;t.left!=g&&e(t.left,i);t.right!=g&&e(t.right,i)}(this.root,0)}},{key:"mapIntervals",value:function(e){!function t(i){e(i.interval);i.left!=g&&t(i.left);i.right!=g&&t(i.right)}(this.root)}},{key:"searchAll",value:function(e,t,i){return t.interval.overlaps(e)&&i.push(t.interval),t.left!=g&&t.left.max>=e.low&&this.searchAll(e,t.left,i),t.right!=g&&t.right.min<=e.high&&this.searchAll(e,t.right,i),i}},{key:"leftRotate",value:function(e){var t=e.right;e.right=t.left,t.left!=g&&(t.left.parent=e),t.parent=e.parent,e.parent==g?this.root=t:e.parent.left==e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,this.applyUpdate(e)}},{key:"rightRotate",value:function(e){var t=e.left;e.left=t.right,t.right!=g&&(t.right.parent=e),t.parent=e.parent,e.parent==g?this.root=t:e.parent.right==e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,this.applyUpdate(e)}},{key:"treeInsert",value:function(e){for(var t=this.root,i=g;t!=g;)i=t,t=e.interval.low<=t.interval.low?t.left:t.right;e.parent=i,i==g?(this.root=e,e.left=e.right=g):e.interval.low<=i.interval.low?i.left=e:i.right=e,this.applyUpdate(e)}},{key:"applyUpdate",value:function(e){for(;e!=g;){var t=e.left.max>e.right.max?e.left.max:e.right.max,i=e.interval.high;e.max=t>i?t:i;var n=e.left.min<e.right.min?e.left.min:e.right.min,r=e.interval.low;e.min=n<r?n:r,e=e.parent}}}]),e}(),b=function(){function e(t,i,n){l(this,e),this.low=t,this.high=i,this.value=n}return n(e,[{key:"equals",value:function(e){return!!e&&(this==e||this.low==otherInterval.low&&this.high==otherInterval.high)}},{key:"compareTo",value:function(e){return this.low<e.low?-1:this.low>e.low?1:this.high<e.high?-1:this.high>e.high?1:0}},{key:"overlaps",value:function(e){try{return this.low<=e.high&&e.low<=this.high}catch(e){igv.presentAlert(e)}}}]),e}(),_=function e(t){l(this,e),this.parent=g,this.left=g,this.right=g,this.interval=t,this.color=2},m=function(){function e(t,i,n,r){l(this,e),this.chr=t,this.start=i,this.end=n,this.features=r}return n(e,[{key:"contains",value:function(e,t,i){return this.chr==e&&this.start<=t&&this.end>=i}},{key:"containsRange",value:function(e){return this.chr===e.chr&&this.start<=e.start&&this.end>=e.end}}]),e}(),k=function(){function e(t){l(this,e),this.file=t,this.indexed=!0,this.indexed&&(this.indexFile=this.file+".fai")}return n(e,[{key:"init",value:function(){var e=this;return e.indexed?new Promise(function(t,i){e.getIndex().then(function(i){var n=0;e.chromosomes={},e.chromosomeNames.forEach(function(t){var i=e.index[t].size;e.chromosomes[t]=new igv.Chromosome(t,n++,i)}),t()}).catch(i)}):e.loadAll()}},{key:"getSequence",value:function(e,t,i){return this.indexed?this.getSequenceIndexed(e,t,i):getSequenceNonIndexed.this(e,t,i)}},{key:"getSequenceIndexed",value:function(e,t,i){var n=this;return new Promise(function(r,a){var s=n.interval;if(s&&s.contains(e,t,i))r(c(s,t,i));else{var o=t,l=i;if(i-t<1e5){var h=i-t,u=Math.round(t+h/2);o=Math.max(0,u-5e4),l=u+5e4}n.readSequence(e,o,l).then(function(a){n.interval=new m(e,o,l,a),r(c(n.interval,t,i))}).catch(a)}function c(e,t,i){var n=t-e.start,r=i-t;return e.features?e.features.substr(n,r):null}})}},{key:"getSequenceNonIndexed",value:function(e,t,i){var n=this;return new Promise(function(r,a){var s=n.sequences[e];s&&s.length>i&&r(s.substring(t,i))})}},{key:"getIndex",value:function(){var e=this;return new Promise(function(t,i){e.index?t(e.index):a.igvxhr.load(e.indexFile,{}).then(function(i){var n=i.split("\n"),r=n.length,a=0;for(e.chromosomeNames=[],e.index={};a<r;){var s=n[a++].split("\t");if(5==s.length){var o=s[0],l={size:parseInt(s[1]),position:parseInt(s[2]),basesPerLine:parseInt(s[3]),bytesPerLine:parseInt(s[4])};e.chromosomeNames.push(o),e.index[o]=l}}t&&t(e.index)}).catch(i)})}},{key:"loadAll",value:function(){var e=this;return new Promise(function(t,i){e.chromosomeNames=[],e.chromosomes={},e.sequences={},a.igvxhr.load(e.file,{withCredentials:e.withCredentials}).then(function(i){for(var n,r,a=i.splitLines(),s=a.length,o=0,l="",h=0;o<s;)(n=a[o++].trim()).startsWith("#")||0===n.length||(n.startsWith(">")?(l&&(e.chromosomeNames.push(r),e.sequences[r]=l,e.chromosomes[r]=new igv.Chromosome(r,h++,l.length)),r=n.substr(1).split("\\s+")[0],l=""):l+=n);t()})})}},{key:"readSequence",value:function(e,t,i){var n=this;return new Promise(function(r,s){n.getIndex().then(function(){var o=n.index[e];if(o){var l=Math.max(0,t),h=Math.min(o.size,i),u=o.bytesPerLine,c=o.basesPerLine,f=o.position,d=u-c,p=Math.floor(l/c),v=Math.floor(h/c),g=l-p*c,y=f+p*u+g,b=f+v*u+(h-v*c)-1-y+1;b<=0&&r(null),a.igvxhr.load(n.file,{range:{start:y,size:b}}).then(function(e){var t,i="",n=0,a=e.length;for(g>0&&(t=Math.min(h-l,c-g),i+=e.substr(n,t),n+=t+d,t);n<a;)t=Math.min(c,a-n),i+=e.substr(n,t),n+=t+d,t;r(i)}).catch(s)}else console.log("No index entry for chr: "+e),n.interval=new m(e,t,i,null),r(null)}).catch(s)})}}]),e}();t.FeatureSource=h,t.FastaSequence=k,t.BigBedFeatureSource=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MLVPanel=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(3),a=i(4),s=i(9);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=function(){function e(t,i){o(this,e),i||(i={});var n=i.height?i.height:200,s=i.width?i.width:400,l=null;i.div?(n=(l=$("#"+i.div)).height(),s=l.width()):l=$("<div>").height(n).width(s),this.tracks={},this.track_order=[];var h=!0,u=!1,c=void 0;try{for(var f,d=t[Symbol.iterator]();!(h=(f=d.next()).done);h=!0){var p=f.value,v=r.MLVTrack.getTrack(p);this.tracks[v.config.track_id]=v,this.track_order.push(v.config.track_id)}}catch(e){u=!0,c=e}finally{try{!h&&d.return&&d.return()}finally{if(u)throw c}}this._tracksChanged(),this.legend=null,this.trackDiv=l.addClass("igv-track-div").css("position","absolute"),this.canvas=$('<canvas class = "igv-content-canvas">')[0],this.trackDiv.append(this.canvas),this.canvas.setAttribute("width",s),this.canvas.setAttribute("height",n),this.ctx=this.canvas.getContext("2d"),this.trackDiv.append(a.Utils.spinner());$("<div>").css({"z-index":100,position:"absolute",top:"2px",right:"2px"}).appendTo(this.trackDiv).attr("class","panel-icon-div");this.is_dragging=!1,this.isMouseDown=!1,this.lastMouseX=void 0,this.mouseDownX=void 0,this.buffer_level=1,this.groups={},this.listeners={panel_empty:new Map,track_added:new Map,track_removed:new Map,view_changed:new Map,feature_clicked:new Map,feature_over:new Map,range_selected:new Map},i.allow_user_drag&&this.allowUserDrag(),i.allow_user_zoom&&this.allowUserZoom(),i.allow_user_resize&&this.allowUserResize(i.allow_user_resize),i.allow_user_move&&this.allowUserMove(i.allow_user_move),i.allow_user_feature_click&&this.allowUserFeatureClick(),i.allow_user_feature_over&&this.allowUserFeatureOver(),i.allow_user_close&&this.allowUserClose(),i.allow_user_drop&&this.allowUserDrop()}return n(e,[{key:"setBufferLevel",value:function(e){this.buffer_level=e}},{key:"getDiv",value:function(){return this.trackDiv}},{key:"addLegend",value:function(){this.legend=new s.PanelLegend(this)}},{key:"addRulerTrack",value:function(){var e=new r.RulerTrack,t=e.getConfig();return this.tracks[t.track_id]=e,this.track_order.unshift(t.track_id),this}},{key:"addListener",value:function(e,t,i){var n=this.listeners[e];return n?(i||(i=e+"_"+n.size),n.set(i,t),i):null}},{key:"removeListener",value:function(e,t){var i=this.listeners[e];return!!i&&i.delete(t)}},{key:"addTrack",value:function(e){var t=r.MLVTrack.getTrack(e);this.tracks[e.track_id]=t,this.track_order.push(e.track_id),this._tracksChanged(),this.legend&&this.legend.addTrack(e),this._callListeners("track_added",e)}},{key:"_callListeners",value:function(e,t){for(var i in this.listeners[e])this.listeners[e][i](t)}},{key:"removeTrack",value:function(e){this.track_order=this.track_order.filter(function(t){return t!==e}),this.repaint(!0,!0),this.legend&&this.legend.removeTrack(e);var t=this.tracks[e].config;if(delete this.tracks[e],this._callListeners("track_removed",t),0===this.track_order.length)for(var i in this.listeners.panel_empty)this.listeners.panel_empty[i](this)}},{key:"setTrackAttribute",value:function(e,t,i){this.tracks[e].setConfigAttribute(t,i),"color"!==t&&"display"!==t||!this.legend||this.legend.updateTrack(e)}},{key:"setTrackAttributes",value:function(e,t){var i=this.tracks[e];for(var n in t)i.setConfigAttribute(n,t[n]),"color"===n&&this.legend&&this.legend.updateTrack(e)}},{key:"setTrackFeatureFilter",value:function(e,t){this.tracks[e].setFilterFunction(t)}},{key:"setTrackColorFunction",value:function(e,t){this.tracks[e].setColorFunction(t)}},{key:"_tracksChanged",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.track_order[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a=n.value,s=this.tracks[a],o=s.config.scale_link_to;if(o){var l=this.tracks[o];l&&(s.scale_link_to=l)}}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}},{key:"update",value:function(e,t,i,n){this.call_update_listener=n,e?(this.chr=e,this.start=t,this.end=i,this.repaint()):this.repaint(!0,!0)}},{key:"getAllFeatures",value:function(e,t,i,n){var r=[],a=!0,s=!1,o=void 0;try{for(var l,h=this.track_order[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var u=l.value,c=this.tracks[u];r.push(c.getFeatures(this.chr,e,t,i,n))}}catch(e){s=!0,o=e}finally{try{!a&&h.return&&h.return()}finally{if(s)throw o}}return Promise.all(r)}},{key:"repaint",value:function(e,t){var i,n,r,s,o,l,u,c=this;o=this.chr,l=this.start,u=this.end,this.bpPerPixel=(this.end-this.start)/this.canvas.width;var f=!0;if(this.tile&&this.tile.containsRange(o,l,u,this.bpPerPixel)&&(f=!1),f||e||this.force_redraw){if(this.force_redraw=!1,i=(2*this.buffer_level+1)*this.canvas.width,n=Math.round(i*this.bpPerPixel),r=Math.max(0,Math.round(this.start-this.buffer_level*this.canvas.width*this.bpPerPixel)),s=r+n,t&&(r=this.tile.startBP,s=this.tile.endBP),c.loading)return;c.loading={start:r,end:s},a.Utils.startSpinnerAtParentElement(c.trackDiv),c.getAllFeatures(r,s,!f,{pixelWidth:i,bpPerPixel:c.bpPerPixel}).then(function(e){if(a.Utils.stopSpinnerAtParentElement(c.trackDiv),e){c.retries=0;var t=document.createElement("canvas");t.width=i,t.height=c.canvas.height;var n={context:t.getContext("2d"),bpStart:r,bpPerPixel:c.bpPerPixel,pixelWidth:t.width,pixelHeight:t.height},l=0;for(var u in c.groups={},e){var f=c.tracks[c.track_order[u]];n.features=e[u];var d=f.config.group;d?(c.groups[d]||(c.groups[d]={top:l,height:f.config.height}),n.top=c.groups[d].top,n.height=c.groups[d].height):n.top=l;var p=f.drawFeatures(n);p&&(l=p)}c.loading=!1,c.tile=new h(o,r,s,c.bpPerPixel,t),c.paintImage(),c.call_update_listener||c.listeners.view_changed.forEach(function(e){e(c.chr,c.start,c.end)}),c.call_update_listener=!1}else c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height)}).catch(function(e){c.loading=!1,console.log(e),e instanceof igv.AbortLoad?console.log("Aborted ---"):(igv.stopSpinnerAtParentElement(c.trackDiv),console.log(e),igv.presentAlert(e))})}else this.force_redraw=!1,this.paintImage(),c.call_update_listener||c.listeners.view_changed.forEach(function(e){e(c.chr,c.start,c.end)}),c.call_update_listener=!1,c.retries=0}},{key:"paintImage",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.tile&&(this.xOffset=Math.round((this.tile.startBP-this.start)/this.bpPerPixel),this.ctx.drawImage(this.tile.image,this.xOffset,0),this.ctx.save(),this.ctx.restore())}},{key:"allowUserFeatureOver",value:function(){var e=this;$(this.canvas).on("mousemove.feature_over",function(t){e.loading||(clearTimeout(e.moto),e.moto=setTimeout(function(){if(!e.is_dragging){var i=e.getFeatureAt(t),n=e.mouse_over_feature;if(i.feature)n&&n.feature!==i.feature&&e.listeners.feature_over.forEach(function(e){e(n.track,n.feature,t,"out")}),n&&n.feature===i.feature||(e.listeners.feature_over.forEach(function(e){e(i.track,i.feature,t,"over")}),e.mouse_over_feature=i);else{var r=e.mouse_over_feature;r&&(e.listeners.feature_over.forEach(function(e){e(r.track,r.feature,t,"out")}),e.mouse_over_feature=null)}}},10))})}},{key:"removeFeatureOverHandler",value:function(){$(this.canvas).off("mousedown.feature_over")}},{key:"allowUserFeatureClick",value:function(){var e=this;this.allowUserFeatureOver(),this.addListener("feature_over",function(t,i,n,r){i||e.trackDiv.css("cursor","default");var a="over"===r?"pointer":"default";e.trackDiv.css("cursor",a)}),$(this.canvas).on("mousedown.feature_click",function(t){e.loading||(clearTimeout(e.to),e.to=setTimeout(function(){if(e.is_dragging)console.log("sss");else{var i=e.getFeatureAt(t);i.track&&e.listeners.feature_clicked.forEach(function(e){e(i.track,i.feature,t)})}},200))})}},{key:"removeFeatureOverHandler",value:function(){$(this.canvas).off("mousedown.feature_click")}},{key:"allowUserDrag",value:function(){var e=this;return $(e.canvas).on("mousedown.draghandler",function(t){if(!t.shiftKey){var i=a.Utils.translateMouseCoordinates(t,e.canvas);e.isMouseDown=!0,e.start_dragging=!0,e.lastMouseX=i.x,e.mouseDownX=e.lastMouseX}}).on("mousemove.draghandler",function(t){var i=a.Utils.translateMouseCoordinates(t,e.canvas);if(e.is_dragging||e.start_dragging){var n=i.x-e.lastMouseX,r=e.bpPerPixel*n;e.start-=r,e.end-=r,e.repaint(),e.lastMouseX=i.x,e.start_dragging&&n>5&&(e.is_dragging=!0,e.start_dragging=!1)}}).on("mouseup.draghandler",function(t){e.is_dragging=!1,e.start_dragging=!1}),this}},{key:"removeDragHandler",value:function(){$(this.canvas).off("mousedown.draghandler mousemove.draghandler mouseup.draghandler")}},{key:"allowUserZoom",value:function(){var e=this;return $(e.canvas).on("mousewheel.zoom  mouse.zoom",function(t){if(!(e.loading||e.bpPerPixel<.05&&t.originalEvent.deltaY>0)){var i=a.Utils.translateMouseCoordinates(t,e.canvas),n=t.originalEvent.deltaY<0?2:.5,r=e.start+i.x*e.bpPerPixel,s=(e.end-e.start)*n,o=r-i.x/e.canvas.width*s;e.start=o,e.end=o+s,e.repaint()}}),this}},{key:"disableUserZoom",value:function(){$(this.canvas).off("mousewheel.zoom")}},{key:"setHighlight",value:function(e,t){}},{key:"allowUserRangeSelection",value:function(){var e=this;this.trackDiv.on("mousedown.selection",function(t){if(t.shiftKey){e.start_select=a.Utils.translateMouseCoordinates(t,this).x;var i=e.start_select+"px",n=$(this);e.select_div=$("<div>").css({position:"absolute",opacity:.2,"background-color":"blue",top:"0px",height:n.css("height"),left:i,width:"0px"}).appendTo(n),t.stopPropagation()}}).on("mousemove.selection",function(t){if(t.shiftKey&&e.start_select){var i=a.Utils.translateMouseCoordinates(t,this).x;i<e.start_select?e.select_div.css({left:i+"px",width:e.start_select-i+"px"}):e.select_div.css({left:e.start_select+"px",width:i-e.start_select+"px"}),t.stopPropagation()}}).on("mouseup.selection",function(t){if(e.start_select){var i=a.Utils.translateMouseCoordinates(t,this).x,n=e.start+e.start_select*e.bpPerPixel,r=e.start+i*e.bpPerPixel;if(e.start_select=null,e.select_div.remove(),n>r){var s=r;r=n,n=s}e.listeners.range_selected.forEach(function(t){t(e.chr,n,r)})}})}},{key:"highlightRegion",value:function(e,t,i){var n=(t-this.start)/this.bpPerPixel+"px",r=(i-t)/this.bpPerPixel+"px",a=this.trackDiv;this.highlight_div?this.highlight_div.css({left:n,width:r}):this.highlight_div=$("<div>").css({position:"absolute",opacity:.2,"background-color":"blue",top:"0px",height:a.css("height"),left:n,width:r}).appendTo(a)}},{key:"removeAllowSelection",value:function(){$(this.canvas).off("mousedown.selection mousemove.selection mouseup.selection")}},{key:"allowUserDrop",value:function(){var e=this;return this.trackDiv.droppable({over:function(t,i){var n=i.draggable.data("track");if(i.draggable.data("panel")!==e&&n){var r="<span class='ui-icon ui-icon-check'></span>";(n.no_drop||e.tracks[n.track_id])&&(r="<span class='ui-icon  ui-icon-closethick'></span>"),setTimeout(function(){i.helper.prepend(r).css("white-space","nowrap")},20)}},greedy:!0,out:function(e,t){t.helper.find(".ui-icon").remove()},drop:function(t,i){var n=$(i.draggable[0]).data("track");if(i.helper.find(".ui-icon").remove(),n){var r=$(i.draggable[0]).data("panel");r===e||n.no_drop||e.tracks[n.track_id]||(r&&(r.removeTrack(n.track_id),r.update()),e.addTrack(n),e.update())}}}),this}},{key:"getFeatureAt",value:function(e){var t=a.Utils.translateMouseCoordinates(e,this.canvas),i=Math.round(this.start+t.x*this.bpPerPixel);for(var n in this.tracks){var r=this.tracks[n];if(t.y>r.top&&t.y<r.bottom)return{track:r,feature:r.getFeatureAt(i,this.chr,t.y,this.bpPerPixel)}}return{track:null,feature:null}}},{key:"allowUserResize",value:function(e){var t="all";"vertical"===e?t="n,s":"horizontal"===e&&(t="e,w");var i=this;return this.trackDiv.resizable({resize:function(e,t){if(i.loading)return!1;clearTimeout(i.to),i.to=setTimeout(function(e){i.setWidth(t.size.width),i.setHeight(t.size.height),i.update()},100)},handles:t}),this}},{key:"allowUserMove",value:function(e){var t=!1,i="fa-arrows-alt";"vertical"==e?(t="y",i+="-v"):"horizontal"==e&&(t="x",i+="-h");var n=this.trackDiv;n.find(".panel-icon-div").prepend($("<span class='track-handle fas "+i+"'></span>").css({cursor:"move"}));return n.draggable({handle:".track-handle",axis:t}),this}},{key:"allowUserClose",value:function(){var e=this.trackDiv,t=$("<span class='fas fa-times'></span>").css({cursor:"not-allowed"}).click(function(){e.remove()});e.find(".panel-icon-div").append(t)}},{key:"setWidth",value:function(e){$(this.viewportDiv).width(e),$(this.contentDiv).width(e),this.canvas.setAttribute("width",e)}},{key:"setHeight",value:function(e){$(this.viewportDiv).height(e),$(this.contentDiv).height(e),this.canvas.setAttribute("height",e)}},{key:"redrawTile",value:function(e){if(this.tile){var t=this.tile.chr,i=this.tile.startBP,n=this.tile.endBP,r=document.createElement("canvas"),a=this.tile.scale;r.width=this.tile.image.width,r.height=this.tile.image.height;var s=r.getContext("2d");this.track.draw({features:e,context:s,bpStart:i,bpPerPixel:a,pixelWidth:r.width,pixelHeight:r.height}),this.tile=new h(t,i,n,a,r),this.paintImage()}}}]),e}(),h=function(){function e(t,i,n,r,a){o(this,e),this.chr=t,this.startBP=i,this.endBP=n,this.scale=r,this.image=a}return n(e,[{key:"containsRange",value:function(e,t,i,n){return this.scale!==n&&console.log("scale:"+this.scale+"="+n),this.scale.toFixed(3)===n.toFixed(3)&&t>=this.startBP&&i<=this.endBP&&e===this.chr}},{key:"overlapsRange",value:function(e,t,i){return this.chr===e&&this.endBP>=t&&this.startBP<=i}}]),e}();t.MLVPanel=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomAnnotationTrack=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(5),a=i(3);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(e){s(this,t),e.sourceType="custom";var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.header=!0,i}return l(t,r.FeatureSource),n(t,[{key:"retrieveFeatures",value:function(e,t,i,n,r){var a=this;return new Promise(function(n,r){var s=a.config.url+"/"+e+"/"+t+"/"+i;$.ajax({url:s,dataType:"json"}).done(function(e){n(e)})})}}]),t}(),u=function(e){function t(e){return s(this,t),e.format="feature",o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,a.MLVBedTrack),n(t,[{key:"_setFeatureSource",value:function(){this.feature_source=new h(this.config)}}]),t}();a.MLVTrack.custom_tracks.custom_annotation=u,t.CustomAnnotationTrack=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MLVTrackDialog=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(3);var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=r.MLVTrack.parseConfig(t),this.panel=i,this.div=$("<div>"),this.id=e.id++,this.div.dialog({autoOpen:!0,close:function(){$(this).dialog("destroy").remove()},title:this.config.short_label,width:250}),this.init()}return n(e,[{key:"_updatePanelScale",value:function(){this.panel&&(this.panel.setTrackAttribute(this.config.track_id,"max_y",this.config.max_y),this.panel.setTrackAttribute(this.config.track_id,"min_y",this.config.min_y),this.panel.update())}},{key:"init",value:function(){var e=this,t=$("<input>").attr({type:"color"}).change(function(t){$(this).val();e.config.color=$(this).val(),e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"color",e.config.color),e.panel.update())}),i=$("<div class='t-d-div'></div>");if(i.append("<label>Color</label><br>"),i.append(t).appendTo(this.div),t.val(e.config.color).height(15),this.div.append("<hr>"),"wig"===this.config.format){var n="sc-ra-name-"+this.id,r=$("<div class='t-d-div'></div>").append("<label>Scale</label><br>");r.append($("<input>").attr({type:"radio",value:"automatic",checked:"automatic"===this.config.scale,name:n})),r.append($("<span>").text("Automatic")),r.append($("<input>").attr({type:"radio",value:"fixed",checked:"fixed"===this.config.scale,name:n})),r.append($("<span>").text("Fixed")),r.append($("<input>").attr({type:"radio",value:"dynamic",checked:"dynamic"===this.config.scale,name:n})),r.append($("<span>").text("Dynamic")),r.appendTo(this.div),$("input[name='"+n+"']").click(function(t){var i=$("input[name='"+n+"']:checked").val();e.config.scale=i,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"scale",i),delete e.panel.tracks[e.config.track_id].max_y,e.panel.update())}),e.scale_slider=$("<div>").slider({range:!0,min:e.config.min_y,max:e.config.max_y,values:[e.config.min_y,e.config.max_y],slide:function(t,i){e.config.max_y=i.values[1],e.config.min_y=i.values[0],e._updatePanelScale(),e.min_y_input.val(i.values[0]),e.max_y_input.val(i.values[1])}}).css("margin","5px 3px"),e.scale_slider.appendTo(r),e.scale_slider.slider("option","values",[e.config.min_y,e.config.max_y]),e.min_y_input=$("<input>").on("blur keypress",function(t){if("keypress"!==t.type||13===t.which){var i=e.min_y_input.val();(i=parseFloat(i))<e.config.min_y&&e.scale_slider.slider("option","min",i),e.scale_slider.slider("option","values",[i,e.config.max_y]),e.config.min_y=i,e._updatePanelScale()}}).appendTo(r).width(40).val(e.config.min_y),e.max_y_input=$("<input>").on("blur keypress",function(t){if("keypress"!==t.type||13===t.which){var i=e.max_y_input.val();(i=parseFloat(i))>e.config.max_y&&e.scale_slider.slider("option","max",i),e.scale_slider.slider("option","values",[e.config.min_y,i]),e.config.max_y=i,e._updatePanelScale()}}).appendTo(r).width(40).css({float:"right"}).val(e.config.max_y),this.div.append("<hr>");var a="di-ra-name-"+this.id,s=$("<div class='t-d-div'></div>").append("<label>Display</label><br>");s.append($("<input>").attr({type:"radio",value:"fill",checked:"fill"===this.config.display||!this.config.display_type,name:a})),s.append($("<span>").text("Fill")),s.append($("<input>").attr({type:"radio",value:"line",checked:"line"===this.config.display,name:a})),s.append($("<span>").text("Line")),this.div.append(s),$("input[name='"+a+"']").click(function(t){var i=$("input[name='"+a+"']:checked").val();e.config.display=i,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"display",i),e.panel.update())}),this.div.append("<hr>");var o=$("<div>").append("<label>Discrete</label>"),l=$("<input>").attr({type:"checkbox"}).prop("checked",this.config.discrete).click(function(t){e.config.discrete=$(this).prop("checked"),e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"discrete",e.config.discrete),e.panel.update())});o.append(l).append("<br>").append("<label>height:</label>").appendTo(this.div),$("<div>").slider({min:10,max:500,value:e.config.height,slide:function(t,i){e.config.height=i.value,e.panel.setTrackAttribute(e.config.track_id,"height",e.config.height),e.panel.update()}}).css({margin:"5px 3px"}).appendTo(o),o.append("<label>group:</label>").append("<br>"),$("<input>").on("blur keypress",function(t){"keypress"===t.type&&13!==t.which||(e.config.group=$(this).val(),e.panel.setTrackAttribute(e.config.track_id,"group",e.config.group),e.panel.update())}).val(this.config.group).appendTo(o),this.div.append("<hr>")}if("feature"===this.config.format){var h=$("<div>").append("<label>Height</label><br>");e.feature_height_slider=$("<div>").slider({max:40,min:5,slide:function(t,i){e.config.featureHeight=i.value,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"featureHeight",e.config.featureHeight),e.panel.update())}}),e.feature_height_slider.slider("option","value",e.config.featureHeight),h.append(e.feature_height_slider).appendTo(this.div),this.div.append("<hr>");var u=$("<div>").append("<label>Display</label><br>");e.feature_display_select=$("<select>").append("<option>EXPANDED</option>").append("<option>SQUISHED</option>").append("<option>COLLAPSED</option>").change(function(t){e.config.displayMode=$(this).val(),e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"displayMode",e.config.displayMode),e.panel.update())}).val(e.config.displayMode),u.append(e.feature_display_select).appendTo(this.div),this.div.append("<hr>")}var c=$("<div>").append("<label>Opacity</label><br>");e.opacity_slider=$("<div>").slider({max:1,min:0,step:.05,slide:function(t,i){e.config.opacity=i.value,e.panel&&(e.panel.setTrackAttribute(e.config.track_id,"opacity",e.config.opacity),e.panel.update())}}),c.append(e.opacity_slider).appendTo(this.div),e.opacity_slider.slider("option","value",e.config.opacity);var f=this.div.parent();f.find(".ui-dialog-content").css("font-size","12px"),f.find(".ui-dialog-title").css("font-size","12px"),f.find(".ui-dialog-titlebar").css("padding",".2em 1em"),f.find("label").css({"font-weight":"600","margin-right":"3px","margin-top":"4px"})}}]),e}();a.id=0,t.MLVTrackDialog=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PanelLegend=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(8);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.panel=t,this.track_index={},this.div=$("<div>").css({position:"absolute",top:"0px",left:"0px",border:"0.5px solid black","background-color":"white"}),this.li=$("<ul>").css({"list-style-type":"none",padding:"4px",margin:"4px"});var i=!0,n=!1,r=void 0;try{for(var a,s=t.track_order[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;this.addTrack(t.tracks[o].config)}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}var l=this;this.div.append(this.li),this.li.sortable({stop:function(e,t){l._reOrder(t.item)}}),t.trackDiv.append(this.div)}return n(e,[{key:"_reOrder",value:function(e){var t=e.data("track").group,i=e.data("track").track_id,n=[],r=0,a=[];this.li.children().each(function(e,s){var o=$(s).data("track");t&&o.group===t?o.track_id===i?(r=n.length,n.push(o.track_id)):a.push(o.track_id):n.push(o.track_id)});var s=!0,o=!1,l=void 0;try{for(var h,u=a[Symbol.iterator]();!(s=(h=u.next()).done);s=!0){var c=h.value;n.splice(r+1,0,c),r++,this.track_index[c].detach().insertAfter(e),e=this.track_index[c]}}catch(e){o=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(o)throw l}}this.panel.track_order=n,this.panel.update()}},{key:"updateTrack",value:function(e){var t=this.track_index[e],i=t.data("track");t.children().each(function(e,t){t=$(t),0==e?t.css("color",i.color):t.text(i.short_label)})}},{key:"addTrack",value:function(e){var t=this,i=$("<li>").data({track:e,panel:this.panel}).click(function(i){new r.MLVTrackDialog(e,t.panel)}),n=$("<span>").width(15).height(15).css({display:"inline-block","margin-right":"3px"}),a="fas fa-signature";"feature"===e.format?a="fas fa-stream":"ruler"===e.format&&(a="fas fa-ruler-horizontal"),n.attr("class",a).css("color",e.color);var s=$("<span>");i.append(n).append(s),this.li.append(i),this.track_index[e.track_id]=i,this.updateTrack(e.track_id)}},{key:"removeTrack",value:function(e){this.li.children().each(function(t,i){var n=(i=$(i)).data("track");n&&n.track_id===e&&i.remove()}),delete this.track_index[e]}},{key:"hide",value:function(){this.div.hide()}}]),e}();t.PanelLegend=a},function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.loadBamIndex=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(0),a=i(2);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(t,i,n,r){s(this,e),this.firstAlignmentBlock=i,this.indices=t,this.sequenceIndexMap=n,this.tabix=r}return n(e,[{key:"blocksForRange",value:function(t,i,n){var r,a,s,o,l,h,u,c,f,d,p,v,g,y=this.indices[t];if(y){for(r=e.reg2bins(i,n),a=[],s=[],r.forEach(function(e){if(y.binIndex[e])for(var t=y.binIndex[e],i=t.length,n=0;n<i;++n){var r=t[n][0],o=t[n][1];(e<4681?s:a).push({minv:r,maxv:o,bin:e})}}),o=y.linearIndex.length,l=null,h=Math.min(i>>14,o-1),u=Math.min(n>>14,o-1),_=h;_<=u;++_)(c=y.linearIndex[_])&&(!l||c.block<l.block||c.offset<l.offset)&&(l=c);if(f=[],null!=l)for(_=0;_<s.length;++_)((d=s[_]).maxv.block>l.block||d.maxv.block==l.block&&d.maxv.offset>=l.offset)&&f.push(d);for(v=[],_=0;_<f.length;++_)v.push(f[_]);for(_=0;_<a.length;++_)v.push(a[_]);if(v.sort(function(e,t){return 0!=(p=e.minv.block-t.minv.block)?p:e.minv.offset-t.minv.offset}),g=[],v.length>0){for(var b=v[0],_=1;_<v.length;++_){var m=v[_];m.minv.block-b.maxv.block<65e3?b={minv:b.minv,maxv:m.maxv}:(g.push(b),b=m)}g.push(b)}return g}return[]}}],[{key:"reg2bins",value:function(e,t){var i,n=[];for(t>=1<<29&&(t=1<<29),--t,n.push(0),i=1+(e>>26);i<=1+(t>>26);++i)n.push(i);for(i=9+(e>>23);i<=9+(t>>23);++i)n.push(i);for(i=73+(e>>20);i<=73+(t>>20);++i)n.push(i);for(i=585+(e>>17);i<=585+(t>>17);++i)n.push(i);for(i=4681+(e>>14);i<=4681+(t>>14);++i)n.push(i);return n}}]),e}();!function(){function e(t){s(this,e),this.filePosition=0,this.config=t}n(e,[{key:"nextBlock",value:function(){var e=this;return new Promise(function(t,i){r.igvxhr.loadArrayBuffer(e.path,{headers:e.config.headers,range:{start:e.filePosition,size:BLOCK_HEADER_LENGTH},withCredentials:e.config.withCredentials}).then(function(n){var a=new Uint8Array(n),s=(a[11],a[10],a[12],a[13],a[15],a[14],a[17]<<8|a[16]+1);e.filePosition+=BLOCK_HEADER_LENGTH,r.igvxhr.loadArrayBuffer(e.path,{headers:e.config.headers,range:{start:e.filePosition,size:s},withCredentials:e.config.withCredentials}).then(function(i){var n=jszlib_inflate_buffer(i);e.filePosition+=s+8,t(n)}).catch(i)}).catch(i)})}}])}();t.loadBamIndex=function(t,i,n){return new Promise(function(s,l){r.igvxhr.loadArrayBuffer(t,{headers:i.headers,withCredentials:i.withCredentials}).then(function(i){var r,l,h,u,c,f,d,p,v,g,y,b,_,m,k=[],w=Number.MAX_VALUE,x=0;if(i){if(n&&(console.log(e),i=new e.Zlib.Gunzip(new Uint8Array(i)).decompress().buffer),!(21578050===(r=(c=new a.BinaryParser(new DataView(i))).getInt())||n&&21578324===r))throw new Error(t+" is not a "+(n?"tabix":"bai")+" file");if(u=c.getInt(),n)for(c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt(),m={},b=0;b<u;b++){var A=c.getString();m[A]=b}for(_=0;_<u;++_){for(f={},d=[],l=c.getInt(),y=0;y<l;++y)if(37450==(p=c.getInt()))P=c.getInt(),v=c.getVPointer(),g=c.getVPointer(),c.getLong(),c.getLong();else{f[p]=[];var P=c.getInt();for(b=0;b<P;b++)v=c.getVPointer(),g=c.getVPointer(),v&&g&&(v.block<w&&(w=v.block),g.block>x&&(x=g.block),f[p].push([v,g]))}for(h=c.getInt(),b=0;b<h;b++)v=c.getVPointer(),d.push(v);l>0&&(k[_]={binIndex:f,linearIndex:d})}s(new o(k,w,m,n))}else s(null)}).catch(l)})}}).call(this,i(1))},function(e,t,i){"use strict";i.r(t),i.d(t,"jszlib_inflate_buffer",function(){return F}),i.d(t,"arrayCopy",function(){return T});var n=15,r=1440,a=0,s=0,o=1,l=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],h=0,u=9,c=5,f=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],d=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function b(){}function _(){this.was=[0]}b.prototype.inflateInit=function(e,t){return e||(e=n),t&&(t=!1),this.istate=new _,this.istate.inflateInit(this,t?-e:e)},b.prototype.inflate=function(e){return null==this.istate?-2:this.istate.inflate(this,e)},b.prototype.inflateEnd=function(){if(null==this.istate)return-2;var e=istate.inflateEnd(this);return this.istate=null,e},b.prototype.inflateSync=function(){return istate.inflateSync(this)},b.prototype.inflateSetDictionary=function(e,t){return istate.inflateSetDictionary(this,e,t)},_.prototype.inflateReset=function(e){return null==e||null==e.istate?-2:(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=0!=e.istate.nowrap?7:0,e.istate.blocks.reset(e,null),s)},_.prototype.inflateEnd=function(e){return null!=this.blocks&&this.blocks.free(e),this.blocks=null,s},_.prototype.inflateInit=function(e,t){e.msg=null,this.blocks=null;let i=0;return t<0&&(t=-t,i=1),t<8||t>15?(this.inflateEnd(e),-2):(this.wbits=t,e.istate.blocks=new w(e,0!=e.istate.nowrap?null:this,1<<t),this.inflateReset(e),s)},_.prototype.inflate=function(e,t){var i,n;if(null==e||null==e.istate||null==e.next_in)return-2;for(t=4==t?-5:s,i=-5;;)switch(e.istate.mode){case 0:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,8!=(15&(e.istate.method=e.next_in[e.next_in_index++]))){e.istate.mode=13,e.msg="unknown compression method",e.istate.marker=5;break}if(8+(e.istate.method>>4)>e.istate.wbits){e.istate.mode=13,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=1;case 1:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,n=255&e.next_in[e.next_in_index++],((e.istate.method<<8)+n)%31!=0){e.istate.mode=13,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(32&n)){e.istate.mode=7;break}e.istate.mode=2;case 2:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=3;case 3:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=4;case 4:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=5;case 5:return 0==e.avail_in?i:(i=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.adler=e.istate.need,e.istate.mode=6,2);case 6:return e.istate.mode=13,e.msg="need dictionary",e.istate.marker=0,-2;case 7:if(-3==(i=e.istate.blocks.proc(e,i))){e.istate.mode=13,e.istate.marker=0;break}if(i==s&&(i=t),i!=o)return i;if(i=t,e.istate.blocks.reset(e,e.istate.was),0!=e.istate.nowrap){e.istate.mode=12;break}e.istate.mode=8;case 8:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=9;case 9:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=10;case 10:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=11;case 11:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.istate.was[0]!=e.istate.need){e.istate.mode=13,e.msg="incorrect data check",e.istate.marker=5;break}e.istate.mode=12;case 12:return o;case 13:return-3;default:return-2}},_.prototype.inflateSetDictionary=function(e,t,i){var n=0,r=i;return null==e||null==e.istate||6!=e.istate.mode?-2:e._adler.adler32(1,t,0,i)!=e.adler?-3:(e.adler=e._adler.adler32(0,null,0,0),r>=1<<e.istate.wbits&&(n=i-(r=(1<<e.istate.wbits)-1)),e.istate.blocks.set_dictionary(t,n,r),e.istate.mode=7,s)};var m=[0,0,255,255];_.prototype.inflateSync=function(e){var t,i,n,r,a;if(null==e||null==e.istate)return-2;if(13!=e.istate.mode&&(e.istate.mode=13,e.istate.marker=0),0==(t=e.avail_in))return-5;for(i=e.next_in_index,n=e.istate.marker;0!=t&&n<4;)e.next_in[i]==m[n]?n++:n=0!=e.next_in[i]?0:4-n,i++,t--;return e.total_in+=i-e.next_in_index,e.next_in_index=i,e.avail_in=t,e.istate.marker=n,4!=n?-3:(r=e.total_in,a=e.total_out,this.inflateReset(e),e.total_in=r,e.total_out=a,e.istate.mode=7,s)},_.prototype.inflateSyncPoint=function(e){return null==e||null==e.istate||null==e.istate.blocks?-2:e.istate.blocks.sync_point()};var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function w(e,t,i){this.hufts=new Int32Array(3*r),this.window=new Uint8Array(i),this.end=i,this.checkfn=t,this.mode=h,this.reset(e,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new x,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new A}w.prototype.reset=function(e,t){t&&(t[0]=this.check),6==this.mode&&this.codes.free(e),this.mode=h,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(e.adler=this.check=e._adler.adler32(0,null,0,0))},w.prototype.proc=function(e,t){var i,n,r,a,u,c,f;for(a=e.next_in_index,u=e.avail_in,n=this.bitb,r=this.bitk,f=(c=this.write)<this.read?this.read-c-1:this.end-c;;)switch(this.mode){case h:for(;r<3;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}switch(i=7&n,this.last=1&i,i>>>1){case 0:n>>>=3,n>>>=i=7&(r-=3),r-=i,this.mode=1;break;case 1:P(g=new Int32Array(1),y=new Int32Array(1),b=[],_=[],e),this.codes.init(g[0],y[0],b[0],0,_[0],0,e),n>>>=3,r-=3,this.mode=6;break;case 2:n>>>=3,r-=3,this.mode=3;break;case 3:return n>>>=3,r-=3,this.mode=13,e.msg="invalid block type",t=-3,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t)}break;case 1:for(;r<32;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}if((~n>>>16&65535)!=(65535&n))return this.mode=13,e.msg="invalid stored block lengths",t=-3,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);this.left=65535&n,n=r=0,this.mode=0!=left?2:0!=this.last?7:h;break;case 2:if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,write=c,this.inflate_flush(e,t);if(0==f&&(c==end&&0!=read&&(f=(c=0)<this.read?this.read-c-1:this.end-c),0==f&&(this.write=c,t=this.inflate_flush(e,t),f=(c=this.write)<this.read?this.read-c-1:this.end-c,c==this.end&&0!=this.read&&(f=(c=0)<this.read?this.read-c-1:this.end-c),0==f)))return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);if(t=s,(i=this.left)>u&&(i=u),i>f&&(i=f),T(e.next_in,a,window,c,i),a+=i,u-=i,c+=i,f-=i,0!=(this.left-=i))break;this.mode=0!=this.last?7:h;break;case 3:for(;r<14;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}if(this.table=i=16383&n,(31&i)>29||(i>>5&31)>29)return this.mode=9,e.msg="too many length or distance symbols",t=-3,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var d=0;d<i;d++)this.blens[d]=0;n>>>=14,r-=14,this.index=0,this.mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;r<3;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}this.blens[k[this.index++]]=7&n,n>>>=3,r-=3}for(;this.index<19;)this.blens[k[this.index++]]=0;if(this.bb[0]=7,(i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,e))!=s)return-3==(t=i)&&(this.blens=null,this.mode=9),this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,write=c,this.inflate_flush(e,t);this.index=0,this.mode=5;case 5:for(;i=this.table,this.index<258+(31&i)+(i>>5&31);){var p,v;for(i=this.bb[0];r<i;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}if(i=this.hufts[3*(this.tb[0]+(n&l[i]))+1],(v=this.hufts[3*(this.tb[0]+(n&l[i]))+2])<16)n>>>=i,r-=i,this.blens[this.index++]=v;else{for(d=18==v?7:v-14,p=18==v?11:3;r<i+d;){if(0==u)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);t=s,u--,n|=(255&e.next_in[a++])<<r,r+=8}if(r-=i,p+=(n>>>=i)&l[d],n>>>=d,r-=d,(d=this.index)+p>258+(31&(i=this.table))+(i>>5&31)||16==v&&d<1)return this.blens=null,this.mode=9,e.msg="invalid bit length repeat",t=-3,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);v=16==v?this.blens[d-1]:0;do{this.blens[d++]=v}while(0!=--p);this.index=d}}this.tb[0]=-1;var g=new Int32Array(1),y=new Int32Array(1),b=new Int32Array(1),_=new Int32Array(1);if(g[0]=9,y[0]=6,i=this.table,(i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,g,y,b,_,this.hufts,e))!=s)return-3==i&&(this.blens=null,this.mode=13),t=i,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);this.codes.init(g[0],y[0],this.hufts,b[0],this.hufts,_[0],e),this.mode=6;case 6:if(this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,(t=this.codes.proc(this,e,t))!=o)return this.inflate_flush(e,t);if(t=s,this.codes.free(e),a=e.next_in_index,u=e.avail_in,n=this.bitb,r=this.bitk,f=(c=this.write)<this.read?this.read-c-1:this.end-c,0==this.last){this.mode=h;break}this.mode=7;case 7:if(this.write=c,t=this.inflate_flush(e,t),f=(c=this.write)<this.read?this.read-c-1:this.end-c,this.read!=this.write)return this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);this.mode=12;case 8:return t=o,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);case 9:return t=-3,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t);default:return t=-2,this.bitb=n,this.bitk=r,e.avail_in=u,e.total_in+=a-e.next_in_index,e.next_in_index=a,this.write=c,this.inflate_flush(e,t)}},w.prototype.free=function(e){this.reset(e,null),this.window=null,this.hufts=null},w.prototype.set_dictionary=function(e,t,i){T(e,t,window,0,i),this.read=this.write=i},w.prototype.sync_point=function(){return 1==this.mode},w.prototype.inflate_flush=function(e,t){var i,n,r;return n=e.next_out_index,(i=((r=this.read)<=this.write?this.write:this.end)-r)>e.avail_out&&(i=e.avail_out),0!=i&&-5==t&&(t=s),e.avail_out-=i,e.total_out+=i,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,i)),T(this.window,r,e.next_out,n,i),n+=i,(r+=i)==this.end&&(r=0,this.write==this.end&&(this.write=0),(i=this.write-r)>e.avail_out&&(i=e.avail_out),0!=i&&-5==t&&(t=s),e.avail_out-=i,e.total_out+=i,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,i)),T(this.window,r,e.next_out,n,i),n+=i,r+=i),e.next_out_index=n,this.read=r,t};function x(){}function A(){}function P(e,t,i,n,r){return e[0]=u,t[0]=c,i[0]=f,n[0]=d,s}x.prototype.init=function(e,t,i,n,r,a,s){this.mode=0,this.lbits=e,this.dbits=t,this.ltree=i,this.ltree_index=n,this.dtree=r,this.dtree_index=a,this.tree=null},x.prototype.proc=function(e,t,i){var n,r,a,h,u,c,f,d=0,p=0,v=0;for(v=t.next_in_index,h=t.avail_in,d=e.bitb,p=e.bitk,c=(u=e.write)<e.read?e.read-u-1:e.end-u;;)switch(this.mode){case 0:if(c>=258&&h>=10&&(e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,e,t),v=t.next_in_index,h=t.avail_in,d=e.bitb,p=e.bitk,c=(u=e.write)<e.read?e.read-u-1:e.end-u,i!=s)){this.mode=i==o?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(n=this.need;p<n;){if(0==h)return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);i=s,h--,d|=(255&t.next_in[v++])<<p,p+=8}if(r=3*(this.tree_index+(d&l[n])),d>>>=this.tree[r+1],p-=this.tree[r+1],0==(a=this.tree[r])){this.lit=this.tree[r+2],this.mode=6;break}if(0!=(16&a)){this.get=15&a,this.len=this.tree[r+2],this.mode=2;break}if(0==(64&a)){this.need=a,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&a)){this.mode=7;break}return this.mode=9,t.msg="invalid literal/length code",i=-3,e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);case 2:for(n=this.get;p<n;){if(0==h)return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);i=s,h--,d|=(255&t.next_in[v++])<<p,p+=8}this.len+=d&l[n],d>>=n,p-=n,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(n=this.need;p<n;){if(0==h)return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);i=s,h--,d|=(255&t.next_in[v++])<<p,p+=8}if(r=3*(this.tree_index+(d&l[n])),d>>=this.tree[r+1],p-=this.tree[r+1],0!=(16&(a=this.tree[r]))){this.get=15&a,this.dist=this.tree[r+2],this.mode=4;break}if(0==(64&a)){this.need=a,this.tree_index=r/3+this.tree[r+2];break}return this.mode=9,t.msg="invalid distance code",i=-3,e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);case 4:for(n=this.get;p<n;){if(0==h)return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);i=s,h--,d|=(255&t.next_in[v++])<<p,p+=8}this.dist+=d&l[n],d>>=n,p-=n,this.mode=5;case 5:for(f=u-this.dist;f<0;)f+=e.end;for(;0!=this.len;){if(0==c&&(u==e.end&&0!=e.read&&(c=(u=0)<e.read?e.read-u-1:e.end-u),0==c&&(e.write=u,i=e.inflate_flush(t,i),c=(u=e.write)<e.read?e.read-u-1:e.end-u,u==e.end&&0!=e.read&&(c=(u=0)<e.read?e.read-u-1:e.end-u),0==c)))return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);e.window[u++]=e.window[f++],c--,f==e.end&&(f=0),this.len--}this.mode=0;break;case 6:if(0==c&&(u==e.end&&0!=e.read&&(c=(u=0)<e.read?e.read-u-1:e.end-u),0==c&&(e.write=u,i=e.inflate_flush(t,i),c=(u=e.write)<e.read?e.read-u-1:e.end-u,u==e.end&&0!=e.read&&(c=(u=0)<e.read?e.read-u-1:e.end-u),0==c)))return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);i=s,e.window[u++]=this.lit,c--,this.mode=0;break;case 7:if(p>7&&(p-=8,h++,v--),e.write=u,i=e.inflate_flush(t,i),c=(u=e.write)<e.read?e.read-u-1:e.end-u,e.read!=e.write)return e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);this.mode=8;case 8:return i=o,e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);case 9:return i=-3,e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i);default:return i=-2,e.bitb=d,e.bitk=p,t.avail_in=h,t.total_in+=v-t.next_in_index,t.next_in_index=v,e.write=u,e.inflate_flush(t,i)}},x.prototype.free=function(e){},x.prototype.inflate_fast=function(e,t,i,n,r,a,h,u){var c,f,d,p,v,g,y,b,_,m,k,w,x,A,P,S;y=u.next_in_index,b=u.avail_in,v=h.bitb,g=h.bitk,m=(_=h.write)<h.read?h.read-_-1:h.end-_,k=l[e],w=l[t];do{for(;g<20;)b--,v|=(255&u.next_in[y++])<<g,g+=8;if(0!=(p=(f=i)[S=3*((d=n)+(c=v&k))]))for(;;){if(v>>=f[S+1],g-=f[S+1],0!=(16&p)){for(p&=15,x=f[S+2]+(v&l[p]),v>>=p,g-=p;g<15;)b--,v|=(255&u.next_in[y++])<<g,g+=8;for(p=(f=r)[S=3*((d=a)+(c=v&w))];;){if(v>>=f[S+1],g-=f[S+1],0!=(16&p)){for(p&=15;g<p;)b--,v|=(255&u.next_in[y++])<<g,g+=8;if(A=f[S+2]+(v&l[p]),v>>=p,g-=p,m-=x,_>=A)P=_-A,h.window[_++]=h.window[P++],h.window[_++]=h.window[P++],x-=2;else{P=_-A;do{P+=h.end}while(P<0);if(x>(p=h.end-P)){if(x-=p,_-P>0&&p>_-P)do{h.window[_++]=h.window[P++]}while(0!=--p);else T(h.window,P,h.window,_,p),_+=p,P+=p,p=0;P=0}}do{h.window[_++]=h.window[P++]}while(0!=--x);break}if(0!=(64&p))return u.msg="invalid distance code",b+=x=g>>3<(x=u.avail_in-b)?g>>3:x,y-=x,g-=x<<3,h.bitb=v,h.bitk=g,u.avail_in=b,u.total_in+=y-u.next_in_index,u.next_in_index=y,h.write=_,-3;c+=f[S+2],p=f[S=3*(d+(c+=v&l[p]))]}break}if(0!=(64&p))return 0!=(32&p)?(b+=x=g>>3<(x=u.avail_in-b)?g>>3:x,y-=x,g-=x<<3,h.bitb=v,h.bitk=g,u.avail_in=b,u.total_in+=y-u.next_in_index,u.next_in_index=y,h.write=_,o):(u.msg="invalid literal/length code",b+=x=g>>3<(x=u.avail_in-b)?g>>3:x,y-=x,g-=x<<3,h.bitb=v,h.bitk=g,u.avail_in=b,u.total_in+=y-u.next_in_index,u.next_in_index=y,h.write=_,-3);if(c+=f[S+2],0==(p=f[S=3*(d+(c+=v&l[p]))])){v>>=f[S+1],g-=f[S+1],h.window[_++]=f[S+2],m--;break}}else v>>=f[S+1],g-=f[S+1],h.window[_++]=f[S+2],m--}while(m>=258&&b>=10);return b+=x=g>>3<(x=u.avail_in-b)?g>>3:x,y-=x,g-=x<<3,h.bitb=v,h.bitk=g,u.avail_in=b,u.total_in+=y-u.next_in_index,u.next_in_index=y,h.write=_,s},A.prototype.huft_build=function(e,t,i,n,a,o,l,h,u,c,f){var d,p,v,g,y,b,_,m,k,w,x,A,P,S,I;w=0,y=i;do{this.c[e[t+w]]++,w++,y--}while(0!=y);if(this.c[0]==i)return l[0]=-1,h[0]=0,s;for(m=h[0],b=1;b<=15&&0==this.c[b];b++);for(_=b,m<b&&(m=b),y=15;0!=y&&0==this.c[y];y--);for(v=y,m>y&&(m=y),h[0]=m,S=1<<b;b<y;b++,S<<=1)if((S-=this.c[b])<0)return-3;if((S-=this.c[y])<0)return-3;for(this.c[y]+=S,this.x[1]=b=0,w=1,P=2;0!=--y;)this.x[P]=b+=this.c[w],P++,w++;y=0,w=0;do{0!=(b=e[t+w])&&(this.v[this.x[b]++]=y),w++}while(++y<i);for(i=this.x[v],this.x[0]=y=0,w=0,g=-1,A=-m,this.u[0]=0,x=0,I=0;_<=v;_++)for(d=this.c[_];0!=d--;){for(;_>A+m;){if(g++,I=(I=v-(A+=m))>m?m:I,(p=1<<(b=_-A))>d+1&&(p-=d+1,P=_,b<I))for(;++b<I&&!((p<<=1)<=this.c[++P]);)p-=this.c[P];if(I=1<<b,this.hn[0]+I>r)return-3;this.u[g]=x=this.hn[0],this.hn[0]+=I,0!=g?(this.x[g]=y,this.r[0]=b,this.r[1]=m,b=y>>>A-m,this.r[2]=x-this.u[g-1]-b,T(this.r,0,u,3*(this.u[g-1]+b),3)):l[0]=x}for(this.r[1]=_-A,w>=i?this.r[0]=192:f[w]<n?(this.r[0]=this.v[w]<256?0:96,this.r[2]=this.v[w++]):(this.r[0]=o[this.v[w]-n]+16+64,this.r[2]=a[this.v[w++]-n]),p=1<<_-A,b=y>>>A;b<I;b+=p)T(this.r,0,u,3*(x+b),3);for(b=1<<_-1;0!=(y&b);b>>>=1)y^=b;for(y^=b,k=(1<<A)-1;(y&k)!=this.x[g];)g--,k=(1<<(A-=m))-1}return 0!=S&&1!=v?-5:s},A.prototype.inflate_trees_bits=function(e,t,i,n,r){var a;return this.initWorkArea(19),this.hn[0]=0,-3==(a=this.huft_build(e,0,19,19,null,null,i,t,n,this.hn,this.v))?r.msg="oversubscribed dynamic bit lengths tree":-5!=a&&0!=t[0]||(r.msg="incomplete dynamic bit lengths tree",a=-3),a},A.prototype.inflate_trees_dynamic=function(e,t,i,n,r,a,o,l,h){var u;return this.initWorkArea(288),this.hn[0]=0,(u=this.huft_build(i,0,e,257,p,v,a,n,l,this.hn,this.v))!=s||0==n[0]?(-3==u?h.msg="oversubscribed literal/length tree":-4!=u&&(h.msg="incomplete literal/length tree",u=-3),u):(this.initWorkArea(288),(u=this.huft_build(i,e,t,0,g,y,o,r,l,this.hn,this.v))!=s||0==r[0]&&e>257?(-3==u?h.msg="oversubscribed distance tree":-5==u?(h.msg="incomplete distance tree",u=-3):-4!=u&&(h.msg="empty distance tree with lengths",u=-3),u):s)},A.prototype.initWorkArea=function(e){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(e),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<e&&(this.v=new Int32Array(e));for(var t=0;t<e;t++)this.v[t]=0;for(t=0;t<16;t++)this.c[t]=0;for(t=0;t<3;t++)this.r[t]=0;T(this.c,0,this.u,0,15),T(this.c,0,this.x,0,16)};var S="function"==typeof new Uint8Array(1).subarray;function T(e,t,i,n,r){if(0!=r){if(!e)throw"Undef src";if(!i)throw"Undef dest";0==t&&r==e.length?I(e,i,n):S?I(e.subarray(t,t+r),i,n):1==e.BYTES_PER_ELEMENT&&r>100?I(new Uint8Array(e.buffer,e.byteOffset+t,r),i,n):function(e,t,i,n,r){for(var a=0;a<r;++a)i[n+a]=e[t+a]}(e,t,i,n,r)}}function I(e,t,i){t.set(e,i)}function F(e,t,i,r){e=t?new Uint8Array(e,t,i):new Uint8Array(e);var l=new b;l.inflateInit(n,!0),l.next_in=e,l.next_in_index=0,l.avail_in=e.length;for(var h=[],u=0;;){var c=new Uint8Array(32e3);l.next_out=c,l.next_out_index=0,l.avail_out=c.length;var f=l.inflate(a);if(f!=s&&f!=o)throw l.msg;if(0!=l.avail_out){var d=new Uint8Array(c.length-l.avail_out);T(c,0,d,0,c.length-l.avail_out),c=d}if(h.push(c),u+=c.length,f==o)break}if(r&&(r[0]=(t||0)+l.next_in_index),1==h.length)return h[0].buffer;for(var p=new Uint8Array(u),v=0,g=0;g<h.length;++g){var y=h[g];T(y,0,p,v,y.length),v+=y.length}return p.buffer}},function(e,t,i){"use strict";i.r(t);var n=i(6);i(7);window.MLVPanel=n.MLVPanel}]);